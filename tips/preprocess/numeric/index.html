<!doctype html>
<!--
  Minimal Mistakes Jekyll Theme 4.16.4 by Michael Rose
  Copyright 2013-2019 Michael Rose - mademistakes.com | @mmistakes
  Free for personal and commercial use under the MIT license
  https://github.com/mmistakes/minimal-mistakes/blob/master/LICENSE
-->
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
   <link rel="stylesheet" href="/libs/katex/katex.min.css">
     
   <link rel="stylesheet" href="/libs/highlight/github.min.css">
   
  <link rel="stylesheet" href="/css/franklin.css">
<link rel="stylesheet" href="/css/extra.css">
<link rel="stylesheet" href="/css/minimal-mistakes.css">
<link rel="stylesheet" href="/css/adjust.css">
<link rel="stylesheet" href="/css/luminous-basic.min.css">
<link rel="icon" href="/assets/favicon.ico">
<link href="https://use.fontawesome.com/releases/v5.6.1/css/all.css" rel="stylesheet">
<link href="https://fonts.googleapis.com/earlyaccess/notosansjp.css" rel="stylesheet">
<!-- <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css"> -->

<!--[if IE ]>
<style>
  /* old IE unsupported flexbox fixes */
  .greedy-nav .site-title {
    padding-right: 3em;
  }
  .greedy-nav button {
    position: absolute;
    top: 0;
    right: 0;
    height: 100%;
  }
</style>
<![endif]-->

   <title>juliaã§å‰å‡¦ç†å¤§å…¨7</title>  
  <!-- end custom head snippets -->
</head>
<body class="layout--single">
  <div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        <a class="site-title" href="/">Hanafsky.com</a>
        <ul class="visible-links">
          <li class="masthead__menu-item"><a href="/tips/" >Julia-tips</a></li>
          <li class="masthead__menu-item"><a href="/blog/" >Blog</a></li>
          <li class="masthead__menu-item"><a href="/project/" >Projects</a></li>
          <li class="masthead__menu-item"><a href="/about/">About</a></li>
        </ul>
        <button class="greedy-nav__toggle hidden" type="button">
          <span class="visually-hidden">Toggle menu</span>
          <div class="navicon"></div>
        </button>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>

  <div class="initial-content">
    <div id="main" role="main">
      <div class="sidebar sticky">
        <div itemscope itemtype="https://schema.org/Person">
          <div class="author__avatar">
            <img src="/assets/design/author3.png" alt="Dio" itemprop="image">
          </div>
          <div class="author__content">
            <h3 class="author__name" itemprop="name">Kei Hanafusa</h3>
            <p class="author__bio" itemprop="description">Chemical Engineer, <br> living in Osaka, ğŸ—¾</p>
          </div>
          <div class="author__urls-wrapper">
            <button class="btn btn--inverse">Follow</button>
            <ul class="author__urls social-icons">
              <li itemprop="homeLocation" itemscope itemtype="https://schema.org/Place">
                <i class="fas fa-fw fa-map-marker-alt" aria-hidden="true"></i> <span itemprop="name">Osaka, Japan</span></li>
              <li><a href="https://twitter.com/hanafusakei" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-twitter-square" aria-hidden="true"></i> Twitter</a></li>
              <li><a href="https://github.com/hanafsky" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-github" aria-hidden="true"></i> GitHub</a></li>
            </ul>
          </div>

          
          
              

          <div class="author__urls-wrapper">
            <button class="btn btn--inverse">Tag</button>
            <ul class="author__urls social-icons">
              <li>ã‚¿ã‚°</li>
              <li></li>
              <li><a href="/tag/setting/">è¨­å®š</a></li>
              <li><a href="/tag/thirdparty/">ã‚µãƒ¼ãƒ‰ãƒ‘ãƒ¼ãƒ†ã‚£ãƒ©ã‚¤ãƒ–ãƒ©ãƒª</a></li>
              <li><a href="/tag/recipe">ãƒ¬ã‚·ãƒ”</a></li>
            </ul>
          </div>
          
        </div>
      </div>


<!-- Content appended here -->
<div class="franklin-content"><h1 id="juliaã§å‰å‡¦ç†å¤§å…¨_8æ•°å€¤å‹"><a href="#juliaã§å‰å‡¦ç†å¤§å…¨_8æ•°å€¤å‹" class="header-anchor">juliaã§å‰å‡¦ç†å¤§å…¨ 8.æ•°å€¤å‹</a></h1>
<p>juliaã§å‰å‡¦ç†å¤§å…¨ãã®7ã§ã™ã€‚ä»Šå›ã¯æ•°å€¤å‹ã‚’å–ã‚Šæ‰±ã„ã¾ã™ã€‚</p>
<div class="franklin-toc"><ol><li><a href="#æ•°å€¤å‹ã¸ã®å¤‰æ›">æ•°å€¤å‹ã¸ã®å¤‰æ›</a><ol><li><a href="#q_æ§˜ã€…ãªæ•°å€¤å‹ã®å¤‰æ›">Q æ§˜ã€…ãªæ•°å€¤å‹ã®å¤‰æ›</a></li></ol></li><li><a href="#å¯¾æ•°åŒ–ã«ã‚ˆã‚‹éç·šå½¢ãªå¤‰æ›">å¯¾æ•°åŒ–ã«ã‚ˆã‚‹éç·šå½¢ãªå¤‰æ›</a><ol><li><a href="#q_å¯¾æ•°åŒ–">Q å¯¾æ•°åŒ–</a></li></ol></li><li><a href="#ã‚«ãƒ†ã‚´ãƒªåŒ–ã«ã‚ˆã‚‹éç·šå½¢ãªå¤‰æ›">ã‚«ãƒ†ã‚´ãƒªåŒ–ã«ã‚ˆã‚‹éç·šå½¢ãªå¤‰æ›</a><ol><li><a href="#q_æ•°å€¤å‹ã®ã‚«ãƒ†ã‚´ãƒªåŒ–">Q æ•°å€¤å‹ã®ã‚«ãƒ†ã‚´ãƒªåŒ–</a></li></ol></li><li><a href="#æ­£è¦åŒ–">æ­£è¦åŒ–</a><ol><li><a href="#q_æ­£è¦åŒ–">Q æ­£è¦åŒ–</a></li></ol></li><li><a href="#å¤–ã‚Œå€¤ã®é™¤å»">å¤–ã‚Œå€¤ã®é™¤å»</a><ol><li><a href="#q_æ¨™æº–åå·®åŸºæº–ã®å¤–ã‚Œå€¤ã®é™¤å»">Q æ¨™æº–åå·®åŸºæº–ã®å¤–ã‚Œå€¤ã®é™¤å»</a></li></ol></li><li><a href="#ä¸»æˆåˆ†åˆ†æã«ã‚ˆã‚‹æ¬¡å…ƒåœ§ç¸®">ä¸»æˆåˆ†åˆ†æã«ã‚ˆã‚‹æ¬¡å…ƒåœ§ç¸®</a><ol><li><a href="#q_ä¸»æˆåˆ†åˆ†æã«ã‚ˆã‚‹æ¬¡å…ƒåœ§ç¸®">Q ä¸»æˆåˆ†åˆ†æã«ã‚ˆã‚‹æ¬¡å…ƒåœ§ç¸®</a></li></ol></li><li><a href="#æ•°å€¤ã®è£œå®Œ">æ•°å€¤ã®è£œå®Œ</a><ol><li><a href="#q_æ¬ æãƒ¬ã‚³ãƒ¼ãƒ‰ã®å‰Šé™¤">Q æ¬ æãƒ¬ã‚³ãƒ¼ãƒ‰ã®å‰Šé™¤</a></li><li><a href="#q_å®šæ•°è£œå®Œ">Q å®šæ•°è£œå®Œ</a></li><li><a href="#q_å¹³å‡å€¤è£œå®Œ">Q å¹³å‡å€¤è£œå®Œ</a></li><li><a href="#q_pmmã«ã‚ˆã‚‹å¤šé‡ä»£å…¥">Q PMMã«ã‚ˆã‚‹å¤šé‡ä»£å…¥</a></li></ol></li></ol></div>
<h2 id="æ•°å€¤å‹ã¸ã®å¤‰æ›"><a href="#æ•°å€¤å‹ã¸ã®å¤‰æ›" class="header-anchor">æ•°å€¤å‹ã¸ã®å¤‰æ›</a></h2>
<h3 id="q_æ§˜ã€…ãªæ•°å€¤å‹ã®å¤‰æ›"><a href="#q_æ§˜ã€…ãªæ•°å€¤å‹ã®å¤‰æ›" class="header-anchor">Q æ§˜ã€…ãªæ•°å€¤å‹ã®å¤‰æ›</a></h3>
<p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>40000</mn><mi mathvariant="normal">/</mi><mn>3</mn></mrow><annotation encoding="application/x-tex">40000 / 3 </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">4</span><span class="mord">0</span><span class="mord">0</span><span class="mord">0</span><span class="mord">0</span><span class="mord">/</span><span class="mord">3</span></span></span></span>ã‚’ã•ã¾ã–ã¾ãªæ•°å€¤ã®ãƒ‡ãƒ¼ã‚¿å‹ã«å¤‰æ›ã™ã‚‹ã¨ã„ã†ãŠé¡Œã§ã™ã€‚</p>
<h4 id="å‹ã®ç¢ºèª"><a href="#å‹ã®ç¢ºèª" class="header-anchor">å‹ã®ç¢ºèª</a></h4>
<pre><code class="julia hljs">typeof(<span class="hljs-number">40000</span>/<span class="hljs-number">3</span>)</code></pre><pre><code class="plaintext hljs">Float64</code></pre>
<p>ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã®å‹ã‚’ç¢ºèªã™ã‚‹ã¨<code>Float64</code>ã§ã‚ã‚‹ã“ã¨ãŒã‚ã‹ã‚Šã¾ã™ã€‚</p>
<h4 id="æ•´æ•°å‹ã¸å¤‰æ›"><a href="#æ•´æ•°å‹ã¸å¤‰æ›" class="header-anchor">æ•´æ•°å‹ã¸å¤‰æ›</a></h4>
<p>æ•´æ•°å‹ã«å¤‰æ›ã™ã‚‹ã«ã¯<code>round</code>é–¢æ•°ã€ã‚ã‚‹ã„ã¯<code>floor</code>é–¢æ•°ã‚’ç”¨ã„ã¾ã™ã€‚</p>
<pre><code class="julia hljs">round(<span class="hljs-built_in">Int</span>, <span class="hljs-number">40000</span>/<span class="hljs-number">3</span>)</code></pre><pre><code class="plaintext hljs">13333</code></pre>
<pre><code class="julia hljs">floor(<span class="hljs-built_in">Int</span>, <span class="hljs-number">40000</span>/<span class="hljs-number">3</span>)</code></pre><pre><code class="plaintext hljs">13333</code></pre>
<div class="note"><div class="title">ğŸ˜² Note</div>
<div class="content"><p>ã“ã®2ã¤ã®é–¢æ•°ã¯ã¨ãã«é•ã„ãŒç„¡ã•ãã†ã§ã™ãŒã€è² ã®æ•°ã«é©ç”¨ã™ã‚‹å ´åˆã€æ³¨æ„ãŒå¿…è¦ã§ã™ã€‚</p>
<pre><code class="julia hljs">round(<span class="hljs-built_in">Int</span>, -<span class="hljs-number">2.1</span>),floor(<span class="hljs-built_in">Int</span>, -<span class="hljs-number">2.1</span>)</code></pre><pre><code class="plaintext hljs">(-2, -3)</code></pre></div></div>
<h2 id="å¯¾æ•°åŒ–ã«ã‚ˆã‚‹éç·šå½¢ãªå¤‰æ›"><a href="#å¯¾æ•°åŒ–ã«ã‚ˆã‚‹éç·šå½¢ãªå¤‰æ›" class="header-anchor">å¯¾æ•°åŒ–ã«ã‚ˆã‚‹éç·šå½¢ãªå¤‰æ›</a></h2>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>log</mi><mo>â¡</mo><mo stretchy="false">(</mo><mtext>å¹´é½¢</mtext><mo>+</mo><mn>1</mn><mo stretchy="false">)</mo><mo>=</mo><mo stretchy="false">(</mo><mtext>å¯¾æ•°åŒ–ã—ãŸå¹´é½¢</mtext><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">
\log (å¹´é½¢ + 1) = (å¯¾æ•°åŒ–ã—ãŸå¹´é½¢)
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mopen">(</span><span class="mord cjk_fallback">å¹´</span><span class="mord cjk_fallback">é½¢</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord cjk_fallback">å¯¾</span><span class="mord cjk_fallback">æ•°</span><span class="mord cjk_fallback">åŒ–</span><span class="mord cjk_fallback">ã—</span><span class="mord cjk_fallback">ãŸ</span><span class="mord cjk_fallback">å¹´</span><span class="mord cjk_fallback">é½¢</span><span class="mclose">)</span></span></span></span></span>
<p>ã®ã‚ˆã†ãªå¯¾æ•°å¤‰æ›ã‚’è¡Œã†ã¨å€¤ãŒå¤§ãããªã‚‹ã»ã©å€¤ã®å·®ã®æ„å‘³ã‚’ãªãã™åŠ¹æœãŒã‚ã‚Šã¾ã™ã€‚ ã¾ãŸã€å›å¸°åˆ†æãªã©ã‚’è¡Œã†ã¨ãã«ç›®çš„å¤‰æ•°ãŒè² ã®å€¤ã‚’ã¨ã‚‹ã¨ã¾ãšã„å ´åˆã«ã€å¯¾æ•°å¤‰æ›ã‚’é©ç”¨ã™ã‚‹ã“ã¨ãŒã‚ã‚Šã¾ã™ã€‚ ã“ã®å ´åˆã€å¯¾æ•°ã‚¹ã‚±ãƒ¼ãƒ«ã§è¦‹ãŸã¨ãã«èª¤å·®ã®åˆ†æ•£ãŒç­‰ã—ã„ä»®å®šã‚’ã™ã‚‹ã“ã¨ã«ãªã‚Šã¾ã™ãŒã€ç´°ã‹ãæ„è­˜ã—ã¦ã„ã‚‹äººã£ã¦ã„ã‚‹ã®ã‹å¶ã«ç–‘å•ã‚’æŠ±ãã¾ã™ã€‚</p>
<h3 id="q_å¯¾æ•°åŒ–"><a href="#q_å¯¾æ•°åŒ–" class="header-anchor">Q å¯¾æ•°åŒ–</a></h3>
<p>ãƒ›ãƒ†ãƒ«ã®äºˆç´„ãƒ¬ã‚³ãƒ¼ãƒ‰ã®total_priceã‚’1000ã§å‰²ã£ã¦1ã‚’è¶³ã—ã¦ã€åº•10ã§å¯¾æ•°åŒ–ã™ã‚‹ã¨ã„ã†ãŠé¡Œã§ã™ã€‚</p>
<p>transformé–¢æ•°ã¨ByRowã¨ç„¡åé–¢æ•°ã‚’ä½¿ã£ã¦é›£ãªãå®Ÿç¾ã§ãã¾ã™ã€‚</p>
<pre><code class="julia hljs"><span class="hljs-keyword">using</span> DataFrames,CSV,Chain,Downloads
reserve_url = <span class="hljs-string">&quot;https://raw.githubusercontent.com/hanafsky/awesomebook/master/data/reserve.csv&quot;</span>

reserve_df = <span class="hljs-meta">@chain</span> reserve_url <span class="hljs-keyword">begin</span> 
                    Downloads.download 
                    CSV.File 
                    DataFrame
                    transform(:total_price=&gt;ByRow(c-&gt;log10(c/<span class="hljs-number">1000</span> + <span class="hljs-number">1</span>))=&gt;:total_price_log)
                    <span class="hljs-keyword">end</span>

first(reserve_df,<span class="hljs-number">10</span>) |&gt; println</code></pre>
<div class="code-output"><pre><code class="plaintext hljs">10Ã—10 DataFrame
 Row â”‚ reserve_id  hotel_id  customer_id  reserve_datetime     checkin_date  checkin_time  checkout_date  people_num  total_price  total_price_log
     â”‚ String7     String7   String7      String31             Dates.Date    Dates.Time    Dates.Date     Int64       Int64        Float64
â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   1 â”‚ r1          h_75      c_1          2016-03-06 13:09:42  2016-03-26    10:00:00      2016-03-29              4        97200         1.99211
   2 â”‚ r2          h_219     c_1          2016-07-16 23:39:55  2016-07-20    11:30:00      2016-07-21              2        20600         1.33445
   3 â”‚ r3          h_179     c_1          2016-09-24 10:03:17  2016-10-19    09:00:00      2016-10-22              2        33600         1.53908
   4 â”‚ r4          h_214     c_1          2017-03-08 03:20:10  2017-03-29    11:00:00      2017-03-30              4       194400         2.29092
   5 â”‚ r5          h_16      c_1          2017-09-05 19:50:37  2017-09-22    10:30:00      2017-09-23              3        68100         1.83948
   6 â”‚ r6          h_241     c_1          2017-11-27 18:47:05  2017-12-04    12:00:00      2017-12-06              3        36000         1.5682
   7 â”‚ r7          h_256     c_1          2017-12-29 10:38:36  2018-01-25    10:30:00      2018-01-28              1       103500         2.01912
   8 â”‚ r8          h_241     c_1          2018-05-26 08:42:51  2018-06-08    10:00:00      2018-06-09              1         6000         0.845098
   9 â”‚ r9          h_217     c_2          2016-03-05 13:31:06  2016-03-25    09:30:00      2016-03-27              3        68400         1.84136
  10 â”‚ r10         h_240     c_2          2016-06-25 09:12:22  2016-07-14    11:00:00      2016-07-17              4       320400         2.50705
</code></pre></div>
<h2 id="ã‚«ãƒ†ã‚´ãƒªåŒ–ã«ã‚ˆã‚‹éç·šå½¢ãªå¤‰æ›"><a href="#ã‚«ãƒ†ã‚´ãƒªåŒ–ã«ã‚ˆã‚‹éç·šå½¢ãªå¤‰æ›" class="header-anchor">ã‚«ãƒ†ã‚´ãƒªåŒ–ã«ã‚ˆã‚‹éç·šå½¢ãªå¤‰æ›</a></h2>
<h3 id="q_æ•°å€¤å‹ã®ã‚«ãƒ†ã‚´ãƒªåŒ–"><a href="#q_æ•°å€¤å‹ã®ã‚«ãƒ†ã‚´ãƒªåŒ–" class="header-anchor">Q æ•°å€¤å‹ã®ã‚«ãƒ†ã‚´ãƒªåŒ–</a></h3>
<p>ãƒ›ãƒ†ãƒ«ã®äºˆç´„ãƒ¬ã‚³ãƒ¼ãƒ‰ã®é¡§å®¢ãƒ†ãƒ¼ãƒ–ãƒ«ã®å¹´é½¢ã‚’10åˆ»ã¿ã®ã‚«ãƒ†ã‚´ãƒªãƒ¼å‹ã¨ã—ã¦è¿½åŠ ã™ã‚‹ã¨ã„ã†ãŠé¡Œã§ã™ã€‚ è¡Œã”ã¨ã®å‡¦ç†ã¨åˆ—å…¨ä½“ã‚’åˆ†ã‘ã¦è¡Œã£ã¦ã„ã‚‹ã®ã§ã€æœ¬ã®pythonã‚³ãƒ¼ãƒ‰ãªã©ã¨æ¯”ã¹ã‚‹ã¨ã‚„ã‚„å†—é•·ãªæ›¸ãæ–¹ã«ãªã£ã¦ã„ã¾ã™ã€‚</p>
<pre><code class="julia hljs"><span class="hljs-keyword">using</span> CategoricalArrays
customer_url = <span class="hljs-string">&quot;https://raw.githubusercontent.com/hanafsky/awesomebook/master/data/customer.csv&quot;</span>
customer_df = <span class="hljs-meta">@chain</span> customer_url Downloads.download CSV.File DataFrame
transform!(customer_df, :age=&gt;ByRow(c-&gt;<span class="hljs-number">10</span>floor(<span class="hljs-built_in">Int</span>,c/<span class="hljs-number">10</span>))=&gt;:age_rank)
transform!(customer_df, :age_rank=&gt;categorical=&gt;:age_rank)

first(customer_df,<span class="hljs-number">10</span>) |&gt; println</code></pre>
<div class="code-output"><pre><code class="plaintext hljs">10Ã—6 DataFrame
 Row â”‚ customer_id  age    sex      home_latitude  home_longitude  age_rank
     â”‚ String7      Int64  String7  Float64        Float64         Catâ€¦
â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   1 â”‚ c_1             41  man            35.0922         136.512  40
   2 â”‚ c_2             38  man            35.3251         139.411  30
   3 â”‚ c_3             49  woman          35.1205         136.511  40
   4 â”‚ c_4             43  man            43.0349         141.24   40
   5 â”‚ c_5             31  man            35.1027         136.524  30
   6 â”‚ c_6             52  man            34.4408         135.39   50
   7 â”‚ c_7             50  man            43.0158         141.231  50
   8 â”‚ c_8             65  woman          38.2013         140.466  60
   9 â”‚ c_9             36  woman          33.3228         130.331  30
  10 â”‚ c_10            34  woman          34.2904         132.303  30
</code></pre></div>
<h2 id="æ­£è¦åŒ–"><a href="#æ­£è¦åŒ–" class="header-anchor">æ­£è¦åŒ–</a></h2>
<p>æ­£è¦åŒ–å‡¦ç†ã«ã‚‚ã„ãã¤ã‹ç¨®é¡ãŒã‚ã‚Šã¾ã™ã€‚</p>
<ul>
<li><p>ä¸­å¿ƒåŒ–: å¹³å‡å€¤ãŒ0ã«ãªã‚‹ã‚ˆã†ã«ã™ã‚‹ã€‚</p>
</li>
<li><p>æ¨™æº–åŒ–: å¹³å‡å€¤ãŒ0ã€ã‹ã¤æ¨™æº–åå·®ãŒ1ã«ãªã‚‹ã‚ˆã†ã«ã™ã‚‹ã€‚</p>
</li>
<li></li>
</ul>
<h3 id="q_æ­£è¦åŒ–"><a href="#q_æ­£è¦åŒ–" class="header-anchor">Q æ­£è¦åŒ–</a></h3>
<p>ãƒ›ãƒ†ãƒ«ã®äºˆç´„ãƒ¬ã‚³ãƒ¼ãƒ‰ã®äºˆç´„äººæ•°ã¨åˆè¨ˆé‡‘é¡ã‚’å¹³å‡0ã€æ¨™æº–åå·®1ã«ãªã‚‹ã‚ˆã†ã«æ­£è¦åŒ–ã™ã‚‹ã¨ã„ã†ãŠé¡Œã§ã™ã€‚ ã“ã®æ­£è¦åŒ–ã«ã¯<code>StatsBase.jl</code>ã®<code>zscore</code>ãŒä½¿ãˆã¾ã™ã€‚</p>
<pre><code class="julia hljs"><span class="hljs-keyword">using</span> StatsBase
transform!(reserve_df,:people_num=&gt;zscore, :total_price=&gt;zscore)
first(reserve_df,<span class="hljs-number">10</span>) |&gt; println</code></pre>
<div class="code-output"><pre><code class="plaintext hljs">10Ã—12 DataFrame
 Row â”‚ reserve_id  hotel_id  customer_id  reserve_datetime     checkin_date  checkin_time  checkout_date  people_num  total_price  total_price_log  people_num_zscore  total_price_zscore
     â”‚ String7     String7   String7      String31             Dates.Date    Dates.Time    Dates.Date     Int64       Int64        Float64          Float64            Float64
â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   1 â”‚ r1          h_75      c_1          2016-03-06 13:09:42  2016-03-26    10:00:00      2016-03-29              4        97200         1.99211            1.30055          -0.0531874
   2 â”‚ r2          h_219     c_1          2016-07-16 23:39:55  2016-07-20    11:30:00      2016-07-21              2        20600         1.33445           -0.483693         -0.74773
   3 â”‚ r3          h_179     c_1          2016-09-24 10:03:17  2016-10-19    09:00:00      2016-10-22              2        33600         1.53908           -0.483693         -0.629857
   4 â”‚ r4          h_214     c_1          2017-03-08 03:20:10  2017-03-29    11:00:00      2017-03-30              4       194400         2.29092            1.30055           0.828138
   5 â”‚ r5          h_16      c_1          2017-09-05 19:50:37  2017-09-22    10:30:00      2017-09-23              3        68100         1.83948            0.408427         -0.317041
   6 â”‚ r6          h_241     c_1          2017-11-27 18:47:05  2017-12-04    12:00:00      2017-12-06              3        36000         1.5682             0.408427         -0.608096
   7 â”‚ r7          h_256     c_1          2017-12-29 10:38:36  2018-01-25    10:30:00      2018-01-28              1       103500         2.01912           -1.37581           0.00393554
   8 â”‚ r8          h_241     c_1          2018-05-26 08:42:51  2018-06-08    10:00:00      2018-06-09              1         6000         0.845098          -1.37581          -0.88011
   9 â”‚ r9          h_217     c_2          2016-03-05 13:31:06  2016-03-25    09:30:00      2016-03-27              3        68400         1.84136            0.408427         -0.314321
  10 â”‚ r10         h_240     c_2          2016-06-25 09:12:22  2016-07-14    11:00:00      2016-07-17              4       320400         2.50705            1.30055           1.9706
</code></pre></div>
<p>ãªãŠã€zscoreã§ã¯æ¨™æœ¬æ¨™æº–åå·®ãŒé©ç”¨ã•ã‚Œã‚‹ã“ã¨ã«æ„è­˜ã—ã¦ãŠãå¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚ ã¾ãŸã€ <div class="note"><div class="title">ğŸ˜² Note</div>
<div class="content"><p>å…¨ã¦ã®åˆ—ã«é©ç”¨ã™ã‚‹ã¨ãã¯mapcolsã‚ã‚‹ã„ã¯mapcols&#33;ãŒä½¿ãˆã¾ã™ã€‚</p>
<pre><code class="julia hljs">mapcols(zscore,df)</code></pre></div></div></p>
<p>ã¾ãŸã€æœ€å°å€¤0ã€æœ€å¤§å€¤1ã§ã‚¹ã‚±ãƒ¼ãƒªãƒ³ã‚°ã™ã‚‹ã«ã¯StatsBase.jlã«UnitRangeTransormãŒç”¨æ„ã•ã‚Œã¦ã„ã¾ã™ã€‚</p>
<pre><code class="julia hljs">standardize(UnitRangeTransform, [<span class="hljs-number">0.0</span> -<span class="hljs-number">0.5</span> <span class="hljs-number">0.5</span>; <span class="hljs-number">0.0</span> <span class="hljs-number">1.0</span> <span class="hljs-number">2.0</span>], dims=<span class="hljs-number">2</span>)</code></pre><pre><code class="plaintext hljs">2Ã—3 Matrix{Float64}:
 0.5  0.0  1.0
 0.0  0.5  1.0</code></pre>
<p>ãŸã ã€DataFrameã«ã¯é©ç”¨ã§ããªã„ã‚ˆã†ãªã®ã§ã€ã‚‚ã—ã‚„ã‚ŠãŸã„ãªã‚‰æ¬¡ã®ã‚ˆã†ã«é©å½“ãªé–¢æ•°ã‚’ä½œã£ã¦é©ç”¨ã—ãŸã»ã†ãŒã„ã„ã§ã—ã‚‡ã†ã€‚</p>
<pre><code class="julia hljs">unitrangetransform(v)=(v-minimum(v))/(maximum(v)-minimum(v))
transform(df, :colname=&gt;unitrangetransform)</code></pre>
<h2 id="å¤–ã‚Œå€¤ã®é™¤å»"><a href="#å¤–ã‚Œå€¤ã®é™¤å»" class="header-anchor">å¤–ã‚Œå€¤ã®é™¤å»</a></h2>
<p>æ¨™æº–åŒ–å¾Œã«çµ¶å¯¾å€¤ãŒ3ã‚’è¶…ãˆãªã„ãƒ‡ãƒ¼ã‚¿ã ã‘ã‚’æ¡ç”¨ã—ã¾ã™ã€‚</p>
<h3 id="q_æ¨™æº–åå·®åŸºæº–ã®å¤–ã‚Œå€¤ã®é™¤å»"><a href="#q_æ¨™æº–åå·®åŸºæº–ã®å¤–ã‚Œå€¤ã®é™¤å»" class="header-anchor">Q æ¨™æº–åå·®åŸºæº–ã®å¤–ã‚Œå€¤ã®é™¤å»</a></h3>
<p>zscoreã‚’é©ç”¨ã—ãŸåˆ—ã«å¯¾ã—ã¦ã€çµ¶å¯¾å€¤ãŒ3ä»¥ä¸‹ã®ãƒ‡ãƒ¼ã‚¿ã‚’ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ã—ã¦ã„ã¾ã™ã€‚</p>
<pre><code class="julia hljs">reserve_df2 = <span class="hljs-meta">@chain</span> reserve_df <span class="hljs-keyword">begin</span>
      transform(:total_price=&gt;zscore)
      filter(:total_price_zscore=&gt;(c-&gt;abs(c)â‰¤<span class="hljs-number">3</span>),_)
<span class="hljs-keyword">end</span>

first(reserve_df2,<span class="hljs-number">10</span>) |&gt; println</code></pre>
<div class="code-output"><pre><code class="plaintext hljs">10Ã—12 DataFrame
 Row â”‚ reserve_id  hotel_id  customer_id  reserve_datetime     checkin_date  checkin_time  checkout_date  people_num  total_price  total_price_log  people_num_zscore  total_price_zscore
     â”‚ String7     String7   String7      String31             Dates.Date    Dates.Time    Dates.Date     Int64       Int64        Float64          Float64            Float64
â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   1 â”‚ r1          h_75      c_1          2016-03-06 13:09:42  2016-03-26    10:00:00      2016-03-29              4        97200         1.99211            1.30055          -0.0531874
   2 â”‚ r2          h_219     c_1          2016-07-16 23:39:55  2016-07-20    11:30:00      2016-07-21              2        20600         1.33445           -0.483693         -0.74773
   3 â”‚ r3          h_179     c_1          2016-09-24 10:03:17  2016-10-19    09:00:00      2016-10-22              2        33600         1.53908           -0.483693         -0.629857
   4 â”‚ r4          h_214     c_1          2017-03-08 03:20:10  2017-03-29    11:00:00      2017-03-30              4       194400         2.29092            1.30055           0.828138
   5 â”‚ r5          h_16      c_1          2017-09-05 19:50:37  2017-09-22    10:30:00      2017-09-23              3        68100         1.83948            0.408427         -0.317041
   6 â”‚ r6          h_241     c_1          2017-11-27 18:47:05  2017-12-04    12:00:00      2017-12-06              3        36000         1.5682             0.408427         -0.608096
   7 â”‚ r7          h_256     c_1          2017-12-29 10:38:36  2018-01-25    10:30:00      2018-01-28              1       103500         2.01912           -1.37581           0.00393554
   8 â”‚ r8          h_241     c_1          2018-05-26 08:42:51  2018-06-08    10:00:00      2018-06-09              1         6000         0.845098          -1.37581          -0.88011
   9 â”‚ r9          h_217     c_2          2016-03-05 13:31:06  2016-03-25    09:30:00      2016-03-27              3        68400         1.84136            0.408427         -0.314321
  10 â”‚ r10         h_240     c_2          2016-06-25 09:12:22  2016-07-14    11:00:00      2016-07-17              4       320400         2.50705            1.30055           1.9706
</code></pre></div>
<h2 id="ä¸»æˆåˆ†åˆ†æã«ã‚ˆã‚‹æ¬¡å…ƒåœ§ç¸®"><a href="#ä¸»æˆåˆ†åˆ†æã«ã‚ˆã‚‹æ¬¡å…ƒåœ§ç¸®" class="header-anchor">ä¸»æˆåˆ†åˆ†æã«ã‚ˆã‚‹æ¬¡å…ƒåœ§ç¸®</a></h2>
<p>ä¸»æˆåˆ†åˆ†æã«ã‚ˆã£ã¦ã€ãƒ‡ãƒ¼ã‚¿ã®æ¬¡å…ƒã‚’åœ§ç¸®ã™ã‚‹ãŠé¡Œã§ã™ã€‚</p>
<h3 id="q_ä¸»æˆåˆ†åˆ†æã«ã‚ˆã‚‹æ¬¡å…ƒåœ§ç¸®"><a href="#q_ä¸»æˆåˆ†åˆ†æã«ã‚ˆã‚‹æ¬¡å…ƒåœ§ç¸®" class="header-anchor">Q ä¸»æˆåˆ†åˆ†æã«ã‚ˆã‚‹æ¬¡å…ƒåœ§ç¸®</a></h3>
<p>PCAã¯MultivariateStats.jlã§å®Ÿè£…ã•ã‚Œã¦ã„ã¾ã™ã€‚ æ³¨æ„ç‚¹ã¯ã€ãƒ‡ãƒ¼ã‚¿è¡Œåˆ—ã‚’è»¢ç½®ã—ã¦æ¸¡ã™å¿…è¦ãŒã‚ã‚‹ã“ã¨ã§ã™ã€‚</p>
<pre><code class="julia hljs">production_url = <span class="hljs-string">&quot;https://raw.githubusercontent.com/hanafsky/awesomebook/master/data/production.csv&quot;</span>
production_df = <span class="hljs-meta">@chain</span> production_url Downloads.download CSV.File DataFrame
<span class="hljs-keyword">import</span> MultivariateStats
X = <span class="hljs-meta">@chain</span> production_df <span class="hljs-keyword">begin</span>
    select(:length,:thickness)
    <span class="hljs-built_in">Matrix</span>
    transpose
<span class="hljs-keyword">end</span>
M = MultivariateStats.fit(MultivariateStats.PCA, X)
MultivariateStats.predict(M, X)</code></pre>
<h2 id="æ•°å€¤ã®è£œå®Œ"><a href="#æ•°å€¤ã®è£œå®Œ" class="header-anchor">æ•°å€¤ã®è£œå®Œ</a></h2>
<p>ã“ã®ç¯€ã¯æ¬ æå€¤ã®å–ã‚Šæ‰±ã„ã«é–¢ã—ã¦ã¾ã¨ã‚ã¦ã„ã¾ã™ã€‚ æ¬ æã«ã¯ã„ãã¤ã‹ç¨®é¡ãŒã‚ã‚‹ã‚ˆã†ã§ã™ã€‚</p>
<ul>
<li><p>MCAR: å®Œå…¨ã«ãƒ©ãƒ³ãƒ€ãƒ ãªæ¬ æ</p>
</li>
<li><p>MAR: ã»ã‹ã®é …ç›®ã«ä¾å­˜ã—ãŸæ¬ æ</p>
</li>
<li><p>MNAR: æ¬ æã—ãŸãƒ‡ãƒ¼ã‚¿ã«ä¾å­˜ã—ãŸæ¬ æ</p>
</li>
</ul>
<p>ä¸€ç•ªç°¡å˜ãªå¯¾å‡¦æ–¹æ³•ã¯æ¬ æå€¤ã‚’å‰Šé™¤ã—ã¦ã—ã¾ã†ã“ã¨ã§ã™ã€‚ ãã®ä»–ã®å¯¾å‡¦æ–¹æ³•ã¨ã—ã¦ã¯ã€å®šæ•°ã«ã‚ˆã‚‹è£œå®Œã€é›†è¨ˆå€¤ï¼ˆå¹³å‡å€¤ãƒ»ä¸­å¤®å€¤ãªã©ï¼‰ã«ã‚ˆã‚‹è£œå®Œã€æ¬ æã—ã¦ã„ãªã„ãƒ‡ãƒ¼ã‚¿ã«åŸºã¥ãäºˆæ¸¬å€¤ã«ã‚ˆã£ã¦è£œå®Œã€æ™‚ç³»åˆ—ã®é–¢ä¿‚ã‹ã‚‰è£œå®Œãªã©ãŒã‚ã‚‹ã‚ˆã†ã§ã™ã€‚</p>
<h3 id="q_æ¬ æãƒ¬ã‚³ãƒ¼ãƒ‰ã®å‰Šé™¤"><a href="#q_æ¬ æãƒ¬ã‚³ãƒ¼ãƒ‰ã®å‰Šé™¤" class="header-anchor">Q æ¬ æãƒ¬ã‚³ãƒ¼ãƒ‰ã®å‰Šé™¤</a></h3>
<p>å¯¾è±¡ãƒ¬ã‚³ãƒ¼ãƒ‰ã¯thicknessã«æ¬ æãŒå­˜åœ¨ã™ã‚‹è£½é€ ãƒ¬ã‚³ãƒ¼ãƒ‰ã§ã™ã€‚ ã¾ãšãƒ‡ãƒ¼ã‚¿ã‚’èª­ã¿è¾¼ã‚€éš›ã«ã€æ¬ æå€¤ã‚’è¡¨ã™æ–‡å­—åˆ—ã‚’ã—ã¦ã„ã‚‹ã‚ˆã†ã«ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰å¼•æ•°ã‚’æŒ‡å®šã—ã¾ã™ã€‚ æ¬ æå€¤ã®é™¤å»ã¯<code>dropmissing</code>é–¢æ•°ã§ç°¡å˜ã«è¡Œãˆã¾ã™ã€‚</p>
<pre><code class="julia hljs">production_missing_url = <span class="hljs-string">&quot;https://raw.githubusercontent.com/hanafsky/awesomebook/master/data/production_missing_num.csv&quot;</span>
production_missing_df = <span class="hljs-meta">@chain</span> production_missing_url <span class="hljs-keyword">begin</span>
    Downloads.download 
    CSV.File(;missingstring=<span class="hljs-string">&quot;None&quot;</span>) 
    DataFrame
<span class="hljs-keyword">end</span>

<span class="hljs-meta">@chain</span> dropmissing(production_missing_df)  first(<span class="hljs-number">10</span>) println</code></pre>
<div class="code-output"><pre><code class="plaintext hljs">10Ã—4 DataFrame
 Row â”‚ type     length    thickness  fault_flg
     â”‚ String1  Float64   Float64    Bool
â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   1 â”‚ E        274.027    40.2411       false
   2 â”‚ D         86.3193   16.9067       false
   3 â”‚ E        123.94      1.01846      false
   4 â”‚ B        175.555    16.4149       false
   5 â”‚ B        244.935    29.0611       false
   6 â”‚ B        226.427    39.7638       false
   7 â”‚ C        331.638    16.8356       false
   8 â”‚ A        200.865    12.1843       false
   9 â”‚ C        276.387    29.8996       false
  10 â”‚ E        168.441     1.26592      false
</code></pre></div>
<h3 id="q_å®šæ•°è£œå®Œ"><a href="#q_å®šæ•°è£œå®Œ" class="header-anchor">Q å®šæ•°è£œå®Œ</a></h3>
<p>æ¬ æå€¤ã‚’1ã«ç½®ãæ›ãˆã¾ã™ã€‚ missingã‚’ç½®ãæ›ãˆã‚‹ã«ã¯ã€SQLã®ä¾‹ã¨åŒã˜ã<code>coalesce</code>ãŒåˆ©ç”¨å¯èƒ½ã§ã™ã€‚</p>
<pre><code class="julia hljs"><span class="hljs-meta">@chain</span> production_missing_df <span class="hljs-keyword">begin</span>
    transform(:thickness=&gt;ByRow(c-&gt;coalesce(c,<span class="hljs-number">1</span>))=&gt;:thickness)
    first(<span class="hljs-number">30</span>) 
    println
<span class="hljs-keyword">end</span></code></pre>
<div class="code-output"><pre><code class="plaintext hljs">30Ã—4 DataFrame
 Row â”‚ type     length    thickness  fault_flg
     â”‚ String1  Float64   Real       Bool
â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   1 â”‚ E        274.027   40.2411        false
   2 â”‚ D         86.3193  16.9067        false
   3 â”‚ E        123.94     1.01846       false
   4 â”‚ B        175.555   16.4149        false
   5 â”‚ B        244.935   29.0611        false
   6 â”‚ B        226.427   39.7638        false
   7 â”‚ C        331.638   16.8356        false
   8 â”‚ A        200.865   12.1843        false
   9 â”‚ C        276.387   29.8996        false
  10 â”‚ E        168.441    1.26592       false
  11 â”‚ D        218.139   33.1354        false
  12 â”‚ E        215.179   41.7599        false
  13 â”‚ D        218.038   11.8363        false
  14 â”‚ E        218.31    39.5786        false
  15 â”‚ D        207.823   38.7026        false
  16 â”‚ E        286.537    5.3755        false
  17 â”‚ C        239.284   18.9418        false
  18 â”‚ C        373.655   11.2548        false
  19 â”‚ E        200.112   17.9743        false
  20 â”‚ C        326.175   44.3079        false
  21 â”‚ B        157.573    0.409495      false
  22 â”‚ B        150.217    8.68243       false
  23 â”‚ C        358.605   25.7004        false
  24 â”‚ C        269.006   16.9575        false
  25 â”‚ B        202.549    1             false
  26 â”‚ D        223.806   19.6508        false
  27 â”‚ B        263.844   34.6643        false
  28 â”‚ B        169.691    1             false
  29 â”‚ A        131.849    4.7216         true
  30 â”‚ E        128.99    16.5232        false
</code></pre></div>
<h3 id="q_å¹³å‡å€¤è£œå®Œ"><a href="#q_å¹³å‡å€¤è£œå®Œ" class="header-anchor">Q å¹³å‡å€¤è£œå®Œ</a></h3>
<p>æ¬ æå€¤ã«å¹³å‡å€¤ã‚’ä»£å…¥ã™ã‚‹ãŠé¡Œã§ã™ã€‚ å¹³å‡ã‚’<code>mean</code>é–¢æ•°ã§è¨ˆç®—ã™ã‚‹ã«ã¯ãƒ“ãƒ«ãƒˆã‚¤ãƒ³ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã®<code>Statistics.jl</code>ã‚’ã‚¤ãƒ³ãƒãƒ¼ãƒˆã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚ ã—ã‹ã—ã€æ¬ æå€¤ã‚’å«ã‚“ã ã¾ã¾ã§å¹³å‡ã‚’è¨ˆç®—ã™ã‚‹ã¨ã€è¨ˆç®—çµæœã‚‚<code>missing</code>ã«ãªã£ã¦ã—ã¾ã„ã¾ã™ã€‚ å„ç¨®çµ±è¨ˆé‡ã‚’ã¾ã¨ã‚ã¦è¨ˆç®—å¯èƒ½ãª<code>describe</code>é–¢æ•°ã‚’åˆ©ç”¨ã™ã‚Œã°ã€æ¬ æå€¤ãŒã‚ã£ã¦ã‚‚å¹³å‡å€¤ã‚’è¨ˆç®—å¯èƒ½ãªã®ã§ã€ã“ã‚Œã‚’åˆ©ç”¨ã™ã‚‹ã“ã¨ã«ã—ã¾ã™ã€‚</p>
<p>å¹³å‡å€¤ã‚’è¨ˆç®—ã—ãŸå¾Œã¯ã€å®šæ•°è£œå®Œã¨åŒæ§˜ã®å‡¦ç†ãŒå¯èƒ½ã§ã™ã€‚ ä»Šå›ã¯<code>Chain.jl</code>ã®<code>@aside</code>ãƒã‚¯ãƒ­ã‚’ä½¿ã£ã¦ã€å¹³å‡å€¤ã®è¨ˆç®—ã‚’ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³å‡¦ç†ã®ä¸­ã«å…¥ã‚Œã¦ã¾ã—ãŸã€‚</p>
<pre><code class="julia hljs"><span class="hljs-meta">@chain</span> production_missing_df <span class="hljs-keyword">begin</span>
    <span class="hljs-meta">@aside</span> M = describe(_, :mean,cols=:thickness) <span class="hljs-comment"># å¹³å‡å€¤ã‚’è¨ˆç®—</span>
    <span class="hljs-meta">@aside</span> thickness_mean = M[!,:mean][<span class="hljs-number">1</span>] <span class="hljs-comment"># ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ¬ãƒ¼ãƒ ã‹ã‚‰å¹³å‡å€¤ã‚’å–ã‚Šå‡ºã™</span>
    transform(:thickness=&gt;ByRow(c-&gt;coalesce(c,thickness_mean))=&gt;:thickness) <span class="hljs-comment"># æ¬ æå€¤ã‚’å¹³å‡å€¤ã§ç½®ãæ›ãˆ</span>
    first(<span class="hljs-number">30</span>) 
    println
<span class="hljs-keyword">end</span></code></pre>
<p><div class="code-output"><pre><code class="plaintext hljs">30Ã—4 DataFrame
 Row â”‚ type     length    thickness  fault_flg
     â”‚ String1  Float64   Float64    Bool
â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   1 â”‚ E        274.027   40.2411        false
   2 â”‚ D         86.3193  16.9067        false
   3 â”‚ E        123.94     1.01846       false
   4 â”‚ B        175.555   16.4149        false
   5 â”‚ B        244.935   29.0611        false
   6 â”‚ B        226.427   39.7638        false
   7 â”‚ C        331.638   16.8356        false
   8 â”‚ A        200.865   12.1843        false
   9 â”‚ C        276.387   29.8996        false
  10 â”‚ E        168.441    1.26592       false
  11 â”‚ D        218.139   33.1354        false
  12 â”‚ E        215.179   41.7599        false
  13 â”‚ D        218.038   11.8363        false
  14 â”‚ E        218.31    39.5786        false
  15 â”‚ D        207.823   38.7026        false
  16 â”‚ E        286.537    5.3755        false
  17 â”‚ C        239.284   18.9418        false
  18 â”‚ C        373.655   11.2548        false
  19 â”‚ E        200.112   17.9743        false
  20 â”‚ C        326.175   44.3079        false
  21 â”‚ B        157.573    0.409495      false
  22 â”‚ B        150.217    8.68243       false
  23 â”‚ C        358.605   25.7004        false
  24 â”‚ C        269.006   16.9575        false
  25 â”‚ B        202.549   19.4704        false
  26 â”‚ D        223.806   19.6508        false
  27 â”‚ B        263.844   34.6643        false
  28 â”‚ B        169.691   19.4704        false
  29 â”‚ A        131.849    4.7216         true
  30 â”‚ E        128.99    16.5232        false
</code></pre></div> 19.4704ã¨ã„ã†ã®ãŒå¹³å‡å€¤ã§ã™ã€‚</p>
<p>å…¬å¼ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã«ã¯æ¬¡ã®å¤šé‡ä»£å…¥æ³•ã«é–¢é€£ã™ã‚‹<code>Impute.jl</code>ã¨ã„ã†ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ãŒã‚ã£ã¦ã€ã“ã¡ã‚‰ã‚’ä½¿ã†ã¨ã‚‚ã†å°‘ã—ã‚¨ãƒ¬ã‚¬ãƒ³ãƒˆã«å‡¦ç†ãŒå¯èƒ½ã§ã™ã€‚</p>
<pre><code class="julia hljs"><span class="hljs-keyword">using</span> Impute
<span class="hljs-meta">@chain</span> production_missing_df <span class="hljs-keyword">begin</span>
    Impute.substitute(;statistic=Impute.mean)
<span class="hljs-keyword">end</span></code></pre>
<h3 id="q_pmmã«ã‚ˆã‚‹å¤šé‡ä»£å…¥"><a href="#q_pmmã«ã‚ˆã‚‹å¤šé‡ä»£å…¥" class="header-anchor">Q PMMã«ã‚ˆã‚‹å¤šé‡ä»£å…¥</a></h3>
<p>PMM&#40;Predictive Mean Matching&#41;ã¯ã€æ®‹å¿µãªãŒã‚‰<code>Impute.jl</code>ã§ã¯å®Ÿè£…ã•ã‚Œã¦ã„ãªã„ã‚ˆã†ã§ã™ã€‚<sup id="fnref:1"><a href="#fndef:1" class="fnref">[1]</a></sup> ï¼ˆé€†ã«å®Ÿè£…ã™ã‚‹ãƒãƒ£ãƒ³ã‚¹ã¨ã‚‚ã„ãˆã¾ã™ã€‚ï¼‰ ãŠã¨ãªã—ãã€RCallã‚„PyCallã§å‡¦ç†ã‚’å‘¼ã³å‡ºã™ã‹ã€<code>Impute.jl</code>ã®åˆ¥ã®è£œå®Œæ³•ã‚’ä½¿ã†ã®ãŒè‰¯ã•ãã†ã§ã™ã€‚</p>
<p><table class="fndef" id="fndef:1">
    <tr>
        <td class="fndef-backref"><a href="#fnref:1">[1]</a></td>
        <td class="fndef-content">ä»–ã®ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚‚ã‚ã‚‹ã«ã¯ã‚ã‚‹ã®ã§ã™ãŒã€RCallã§wrapã—ãŸã‚‚ã®ã®ã‚ˆã†ã§ã™ã€‚</td>
    </tr>
</table>
 
  <div class="prev-next-link">
  <a class="prev-link" href="/tips/preprocess/unfold">
    <p class="prev-next-label">å‰ã®è¨˜äº‹</p>
    <p>
       juliaã§å‰å‡¦ç†å¤§å…¨ å±•é–‹
    </p>
  </a>
</div>
</p>
 <button onclick="topFunction()" id="myBtn" title="Go to top">Top</button> 
    <script src="https://utteranc.es/client.js"
        repo="hanafsky/blog_comments"
        issue-term="pathname"
        label="Comment"
        theme="github-light"
        crossorigin="anonymous"
        async>
    </script>

<div class="page-foot">
  <div class="copyright">
    &copy; Kei Hanafusa. Last modified: August 21, 2022. Website built with <a href="https://github.com/tlienart/Franklin.jl">Franklin.jl</a> and the <a href="https://julialang.org">Julia programming language</a>.
  </div>
</div>
</div><!-- CONTENT ENDS HERE -->

      </div> <!-- closure of main -->
    </div>   <!-- closure of class initial--content -->

    <div class="page__footer">
      <footer>
        <!-- start custom footer snippets -->
        <!-- end custom footer snippets -->
        <div class="page__footer-follow">
          <ul class="social-icons">
            <li><strong>Follow:</strong></li>
            <li><a href="https://twitter.com/hanafusakei" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-twitter-square" aria-hidden="true"></i> Twitter</a></li>
            <li><a href="https://github.com/hanafsky" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-github" aria-hidden="true"></i> GitHub</a></li>
          </ul>
        </div>
        <div class="page__footer-copyright">&copy; Kei Hanafusa. Powered by <a href="https://github.com/tlienart/Franklin.jl">Franklin</a> &amp; <a href="https://mademistakes.com/work/minimal-mistakes-jekyll-theme/" rel="nofollow">Minimal Mistakes</a>.</div>
      </footer>
    </div>

    <script src="/libs/minimal-mistakes/main.min.js"></script>
    <script defer src="https://use.fontawesome.com/releases/v5.8.2/js/all.js" integrity="sha384-DJ25uNYET2XCl5ZF++U8eNxPWqcKohUUBUpKGlNLMchM7q4Wjg2CUpjHLaL8yYPH" crossorigin="anonymous"></script>
    <script src="/libs/myBtn/myBtn.js"></script>
    <script src="/libs/luminous/Luminous.min.js"></script>
    <script src="/libs/clipboard.min.js"></script>

    
        



    
    
        


        <!-- http://tutsplus.github.io/clipboard/ -->

<script>
	(function(){
	
		// Get the elements.
		// - the 'pre' element.
		// - the 'div' with the 'paste-content' id.
	
		var pre = document.getElementsByTagName('pre');
	
		// Add a copy button in the 'pre' element.
		// which only has the className of 'language-'.
	
		for (var i = 0; i < pre.length; i++) {
			var isLanguage = pre[i].children[0].className.indexOf('language-');
	
			if ( isLanguage === 0 ) {
				var button           = document.createElement('button');
						button.className = 'copy-button';
						button.textContent = 'Copy';
	
						pre[i].appendChild(button);
			}
		};
	
		// Run Clipboard
	
		var copyCode = new ClipboardJS('.copy-button', {
			target: function(trigger) {
				return trigger.previousElementSibling;
		}
		});
	
		// On success:
		// - Change the "Copy" text to "Copied".
		// - Swap it to "Copy" in 2s.
		// - Lead user to the "contenteditable" area with Velocity scroll.
	
		copyCode.on('success', function(event) {
			event.clearSelection();
			event.trigger.textContent = 'Copied';
			window.setTimeout(function() {
				event.trigger.textContent = 'Copy';
			}, 2000);
	
		});
	
		// On error (Safari):
		// - Change the  "Press Ctrl+C to copy"
		// - Swap it to "Copy" in 2s.
	
		copyCode.on('error', function(event) {
			event.trigger.textContent = 'Press "Ctrl + C" to copy';
			window.setTimeout(function() {
				event.trigger.textContent = 'Copy';
			}, 5000);
		});
	
	})();
	</script>
        <!-- {{ insert foot_copy.html }} -->
    
    
        <script src="/libs/mermaid/mermaid.min.js"></script>
<script>
  var config
  mermaid.initialize({
    theme: 'neutral',
    themeCSS: '\
               .mermaid-main-font {font-family:"Noto Sans JP"};\
               .section0, .section2{fill:#fadbda;opacity:0.3;};\
               .task0, .task1, .task2, .task3 {fill:#fadbda; stroke:#f6bdc0; stroke-width:1};\
               .grid {stroke:#666;stroke-width:0.5};\
               .node rect,\
               .node circle,\
               .node ellipse,\
               .node path,\
               .node polygon\
               {fill:rgba(253,237,228,0.5);\
                stroke: rgb(246,189,192)};\
               .arrowheadPath {fill:rgb(246,189,192);}\
               .edgePath .path {stroke:rgb(246,189,192);};\
               .cluster rect\
               {fill:rgba(255,249,177,0.3);\
                stroke:rgb(246,189,192)};\
               ',
    // themeCSS: '.node rect {fill:rgba(253,237,228,0.5); stroke: rgb(250,219,218)};',
    // logLevel: 3,
    // securityLevel: 'loose',
    // flowchart: { curve: 'basis' }
  });
</script>
    
    <script>
    new LuminousGallery(document.querySelectorAll('.zoom'));
</script>
    <script>
function myToc() {
    var x = document.getElementsByClassName("mytoc");
    if (x.style.display === "none") {
      x.style.display = "block";
    } else {
      x.style.display = "none";
    }
  } 
</script>
  </body>
</html>
