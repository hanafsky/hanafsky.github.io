<!doctype html> <!-- Minimal Mistakes Jekyll Theme 4.16.4 by Michael Rose Copyright 2013-2019 Michael Rose - mademistakes.com | @mmistakes Free for personal and commercial use under the MIT license https://github.com/mmistakes/minimal-mistakes/blob/master/LICENSE --> <html lang=ja > <meta charset=UTF-8 > <meta name=viewport  content="width=device-width, initial-scale=1"> <link rel=stylesheet  href="/libs/katex/katex.min.css"> <link rel=stylesheet  href="/libs/highlight/github.min.css"> <link rel=stylesheet  href="/css/franklin.css"> <link rel=stylesheet  href="/css/minimal-mistakes.css"> <link rel=stylesheet  href="/css/adjust.css"> <link rel=stylesheet  href="/css/luminous-basic.min.css"> <link rel=icon  href="/assets/favicon.ico"> <link href="https://use.fontawesome.com/releases/v5.6.1/css/all.css" rel=stylesheet > <!--[if IE ]> <style> /* old IE unsupported flexbox fixes */ .greedy-nav .site-title { padding-right: 3em; } .greedy-nav button { position: absolute; top: 0; right: 0; height: 100%; } </style> <![endif]--> <title>ãƒã‚¤ã‚ºã‚’å«ã‚€ãƒ‡ãƒ¼ã‚¿ã®å¾®åˆ†</title> <body class=layout--single > <div class=masthead > <div class=masthead__inner-wrap > <div class=masthead__menu > <nav id=site-nav  class=greedy-nav > <a class=site-title  href="/">Hanafsky.com</a> <ul class=visible-links > <li class=masthead__menu-item ><a href="/tips/" >Julia-tips</a> <li class=masthead__menu-item ><a href="/blog/" >Blog</a> <li class=masthead__menu-item ><a href="/project/" >Projects</a> <li class=masthead__menu-item ><a href="/about/">About</a> </ul> <button class="greedy-nav__toggle hidden" type=button > <span class=visually-hidden >Toggle menu</span> <div class=navicon ></div> </button> <ul class="hidden-links hidden"></ul> </nav> </div> </div> </div> <div class=initial-content > <div id=main  role=main > <div class="sidebar sticky"> <div itemscope itemtype="https://schema.org/Person"> <div class=author__avatar > <img src="/assets/design/author3.png" alt=Dio  itemprop=image > </div> <div class=author__content > <h3 class=author__name  itemprop=name >Kei Hanafusa</h3> <p class=author__bio  itemprop=description >Chemical Engineer, <br> living in Osaka, ğŸ—¾</p> </div> <div class=author__urls-wrapper > <button class="btn btn--inverse">Follow</button> <ul class="author__urls social-icons"> <li itemprop=homeLocation  itemscope itemtype="https://schema.org/Place"> <i class="fas fa-fw fa-map-marker-alt" aria-hidden=true ></i> <span itemprop=name >Osaka, Japan</span> <li><a href="https://twitter.com/hanafusakei" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-twitter-square" aria-hidden=true ></i> Twitter</a> <li><a href="https://github.com/hanafsky" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-github" aria-hidden=true ></i> GitHub</a> </ul> </div> <div class=author__urls-wrapper > <button class="btn btn--inverse">Tag</button> <ul class="author__urls social-icons"> <li>ã‚¿ã‚° <li> <li><a href="/tag/setting/">è¨­å®š</a> <li><a href="/tag/thirdparty/">ã‚µãƒ¼ãƒ‰ãƒ‘ãƒ¼ãƒ†ã‚£ãƒ©ã‚¤ãƒ–ãƒ©ãƒª</a> <li><a href="/tag/recipe">ãƒ¬ã‚·ãƒ”</a> </ul> </div> </div> </div> <div class=franklin-content ><h1 id="ãƒã‚¤ã‚ºã‚’å«ã‚€ãƒ‡ãƒ¼ã‚¿ã®å¾®åˆ†_-_savitzky-golay_filter"><a href="#ãƒã‚¤ã‚ºã‚’å«ã‚€ãƒ‡ãƒ¼ã‚¿ã®å¾®åˆ†_-_savitzky-golay_filter" class=header-anchor >ãƒã‚¤ã‚ºã‚’å«ã‚€ãƒ‡ãƒ¼ã‚¿ã®å¾®åˆ† - Savitzky-Golay filter</a></h1> <p> <div style="text-align:center"> <img src="/assets/tips/smooth-3221868_640.jpg" alt="" height=200px > </div> <div class="sns-container top"> <div class="sns-box b-twitter"> <a href="https://twitter.com/share?url=https://hanafsky.com/tips/savgol/&text=ãƒã‚¤ã‚ºã‚’å«ã‚€ãƒ‡ãƒ¼ã‚¿ã®å¾®åˆ† - Savitzky-Golay filter&via=HanafusaKei&related=HanafusaKei" target=_blank  rel=nofollow ><i class="fab fa-twitter"></i></a></div> <div class="sns-box b-facebook"> <a href="http://www.facebook.com/share.php?u=https://hanafsky.com/tips/savgol/" target=_blank  rel=nofollow ><i class="fab fa-facebook"></i></a></div> <div class="sns-box b-hatena"> <a href="http://b.hatena.ne.jp/add?mode=confirm&url=http://hanafsky.com/tips/savgol/&title=ãƒã‚¤ã‚ºã‚’å«ã‚€ãƒ‡ãƒ¼ã‚¿ã®å¾®åˆ† - Savitzky-Golay filter" target=_blank  rel=nofollow ><span class=icon-hatena ></span></a></div> <div class="sns-box b-pocket"> <a href="http://getpocket.com/edit?url=https://hanafsky.com/tips/savgol/&title=ãƒã‚¤ã‚ºã‚’å«ã‚€ãƒ‡ãƒ¼ã‚¿ã®å¾®åˆ† - Savitzky-Golay filter" rel=nofollow  target=_blank ><i class="fab fa-get-pocket"></i></a></div> <div class="sns-box b-feedly"> <a href='https://feedly.com/i/subscription/feed/https://hanafsky.com/tips/savgol/' target='blank' rel=nofollow ><span class=icon-feedly ></span></a></div> <div class="sns-box b-line"> <a href='https://social-plugins.line.me/lineit/share?url=https://hanafsky.com/tips/savgol/' target='blank' rel=nofollow ><span class=icon-line ></span></a></div> </div> </p> <p>å®Ÿé¨“ãƒ‡ãƒ¼ã‚¿ã‚’è§£æã™ã‚‹ã¨ãã«ã€å‚¾ãã‚„å¤‰æ›²ç‚¹ã‚’æ±‚ã‚ãŸããªã‚‹æ™‚ãŒã‚ã‚Šã¾ã™ã€‚ å…¸å‹çš„ãªã®ãŒã€æ™‚ç³»åˆ—ãƒ‡ãƒ¼ã‚¿ã®è§£æã‚’ã—ã¦ã„ã‚‹ã¨ãã«ã€ãƒ‡ãƒ¼ã‚¿ãŒæ€¥æ¿€ã«å¤‰åŒ–ã— å§‹ã‚ã‚‹ãƒã‚¤ãƒ³ãƒˆã‚’ç‰¹å®šã—ãŸã„ã¨ãã§ã™ã€‚ å­¦ç”Ÿã®é ƒã¯ã€scipyã§å®Ÿè£…ã•ã‚ŒãŸsavitzky-golayãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ã‚’ã‚ˆãä½¿ã£ã¦ã„ãŸã®ã§ã™ãŒã€ juliaã§ã¯å…¬å¼ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã§ä½¿ãˆã‚‹ã‚‚ã®ã¯ãªã•ãã†ã§ã™ã€‚<sup id="fnref:1"><a href="#fndef:1" class=fnref >[1]</a></sup></p> <p>scipyã‚’importã—ã¦ã‚‚è‰¯ã„ã®ã§ã™ãŒã€ <a href="https://pixorblog.wordpress.com/2016/07/13/savitzky-golay-filters-julia/">Vincent-Picaudã•ã‚“ãŒblogã§å…¬é–‹ã—ã¦ã„ã‚‹èª¬æ˜</a>ãŒã¨ã¦ã‚‚åˆ†ã‹ã‚Šã‚„ã™ã„ã®ã§ã€ ãã‚Œã«å‚è€ƒã«ã—ã¦æ—¥æœ¬èªã§åŸç†ã‚’ã¾ã¨ã‚ãŸã‚Šã€juliaã§ã®å®Ÿè£…ã‚’ã¾ã¨ã‚ãŸã„ã¨æ€ã„ã¾ã™ã€‚</p> <div class=footnote  id=footnote-1 ><p class=footnote-title >1</p><p>Vincentã•ã‚“ã®DirectConvolution.jlã§å®Ÿè¡Œå¯èƒ½ã®ã¯ãšãªã®ã§ã™ãŒã€3å¹´ã»ã©ãƒ¡ãƒ³ãƒ†ã•ã‚Œã¦ã„ãªãã¦ã€ç¾åœ¨ã¯ä½¿ç”¨ä¸å¯ã¨ãªã£ã¦ã„ã¾ã™ã€‚</p> </div> <div class=franklin-toc ><ol><li><a href="#savitzkyã¨golayã®å¿ƒ">Savitzkyã¨Golayã®å¿ƒ</a><li><a href="#ç›¸äº’ç›¸é–¢é–¢æ•°">ç›¸äº’ç›¸é–¢é–¢æ•°</a></ol></div> <h2 id="savitzkyã¨golayã®å¿ƒ"><a href="#savitzkyã¨golayã®å¿ƒ" class=header-anchor >Savitzkyã¨Golayã®å¿ƒ</a></h2> <p>ä¸€è¨€ã§çµè«–ã‚’ã¾ã¨ã‚ã‚‹ã¨ã€Œã‚ã‚‹ç‚¹ã«ãŠã‘ã‚‹néšå¾®åˆ†ä¿‚æ•°ã‚’ãƒ†ãƒ¼ãƒ©ãƒ¼å±•é–‹ã¨å¤šé …å¼è¿‘ä¼¼ã‹ã‚‰æ¨å®šã™ã‚‹ã€ã¨ã„ã†ã“ã¨ã«ãªã‚Šã¾ã™ã€‚</p> <p>\((\bm{x},\bm{y}) = [(x_1,y_1), \dots, (x_N,y_N)] (x,y\in\mathbb R, N\in \N)\)ã®ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆãŒã‚ã£ãŸæ™‚ã®ã“ã¨ã‚’è€ƒãˆã¾ã™ã€‚</p> <p>å¤šé …å¼\(P(x)\)ã®\(x = x_k(k\in{1,\dots N})\)ã«ãŠã‘ã‚‹déšå¾®åˆ†ä¿‚æ•°ã‚’\(p^{(d)}(x_k)\)ã¨æ›¸ãã“ã¨ã«ã™ã‚‹ã¨ã€\(x=x_k\)å‘¨ã‚Šã®dæ¬¡ã®ãƒ†ãƒ¼ãƒ©ãƒ¼å±•é–‹ã¯æ¬¡ã®ã‚ˆã†ã«æ›¸ã‘ã¾ã™ã€‚</p> \[P(x) = \sum_{j=0}^{d}\dfrac{(x-x_k)^j}{j!}P^{j}(x_k)\] <p>\(x=x_k\)ã®è¿‘ãã®\(2n+1\)å€‹ã®ç‚¹ã€\(\bm{x}=\{x_{k+i}|i=0, \pm1,\pm2,\dots,\pm n \}\)ã«ã¤ã„ã¦ã€\(P(\bm{x})\)ã‚’è¡Œåˆ—ã§æ›¸ãã¨</p> \[\begin{aligned} P(\bm{x}) &= \begin{bmatrix} \vdots & \vdots & \vdots \\ 1 & \dfrac{(x_i-x_k)^j}{j!} & \dfrac{(x_i-x_k)^d}{d!} \\ \vdots & \vdots & \vdots \end{bmatrix}\cdot \begin{bmatrix} P^{(0)}(x_k) \\ \vdots \\ P^{(j)}(x_k) \\ \vdots \\ P^{(d)}(x_k) \\ \end{bmatrix}\\ &= \begin{bmatrix} \vdots & \vdots & \vdots \\ 1 & (x_i-x_k)^j & (x_i-x_k)^d \\ \vdots & \vdots & \vdots \end{bmatrix}\cdot \begin{bmatrix} 1 & & & & 0 \\ & \ddots & & & \\ & & \dfrac{1}{j!} & & \\ & & & \ddots & \\ 0 & & & &\dfrac{1}{d!} \end{bmatrix}\cdot \begin{bmatrix} P^{(0)}(x_k) \\ \vdots \\ P^{(j)}(x_k) \\ \vdots \\ P^{(d)}(x_k) \\ \end{bmatrix}\\ &= \rm{VD^{-1}P}^{\delta} \end{aligned} \] <p>\(\rm{V}\)ã¯Vendermondeè¡Œåˆ—ã§ã€\(\rm{D}\)ã¯ \(j! (j=0,1,\dots,d)\) ã‚’å¯¾è§’æˆåˆ†ã«ã‚‚ã£ãŸå¯¾è§’è¡Œåˆ—ã§ã™ã€‚ ã¾ãŸã€\(\rm{P}^{\delta}\)ã¯å¾®åˆ†ä¿‚æ•°ã®åˆ—ãƒ™ã‚¯ãƒˆãƒ«ã§ã™ã€‚</p> <p>ä¸€æ–¹ã§ã€\(\bm{y} = \{y_{k-n}, \dots, y_{k+n} \}\)ã‚’\((x-x_k)\)ã®dæ¬¡å¤šé …å¼ã®æœ€å°äºŒä¹—æ³•ã§å›å¸°åˆ†æã™ã‚‹ã¨</p> <p>å›å¸°ä¿‚æ•°ã®æ¨å®šå€¤ã‚’\(\hat{\beta}\)ã¨ã—ã¦</p> \[ \hat{\beta} = (\rm{V}^\mathsf{T}\rm{V})^{-1}\rm{V}^\mathsf{T}\bm{y} \] <p>ã¨æ›¸ã‘ã¾ã™ã‹ã‚‰ã€</p> \[ \begin{aligned} P(\bm{x}) &= \rm{V}\bm{\hat{\beta}} \\ &= \rm{V}(\rm{V}^\mathsf{T}\rm{V})^{-1}\rm{V}^\mathsf{T}\bm{y} \\ &= \rm{VD^{-1}P}^{\delta} \end{aligned} \] <p>ã¨ãªã‚Šã¾ã™ã€‚ \(\rm{VD^{-1}P}^{\delta} =\rm{V}(\rm{V}^\mathsf{T}\rm{V})^{-1}\rm{V}^\mathsf{T}\bm{y}\)ã®ä¸¡è¾ºã«\(V^\mathsf{T}\)ã‚’ã‹ã‘ã¦æ•´ç†ã—ã¦ã„ã‘ã°ã€</p> \[\rm{P}^{\delta} = \rm{D}(\rm{V}^\mathsf{T}\rm{V})^{-1}\rm{V}^\mathsf{T}\bm{y}\] <p>ã¨ãªã£ã¦ã€å¾®åˆ†ä¿‚æ•°ã‚’æ±‚ã‚ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚</p> <p>Vincentã•ã‚“ã¯Vã‚’QRåˆ†è§£ã—ã¦ã•ã‚‰ã«æ•´ç†ã—ã¦ã„ã¾ã™ã€‚ <div class=note ><div class=title >ğŸ˜² Note</div> <div class=content >å®Ÿã¯juliaã§ã¯é€£ç«‹ä¸€æ¬¡æ–¹ç¨‹å¼ã®è§£æ³•ã¯QRåˆ†è§£ã‚’åˆ©ç”¨ã—ã¦ã„ã¾ã™ã€‚ REPLã§<code>?\</code>ã¨ãŸãŸã‘ã°åˆ†ã‹ã‚Šã¾ã™ã€‚</div></div></p> <h2 id="ç›¸äº’ç›¸é–¢é–¢æ•°"><a href="#ç›¸äº’ç›¸é–¢é–¢æ•°" class=header-anchor >ç›¸äº’ç›¸é–¢é–¢æ•°</a></h2> <p>\(\rm{D}(\rm{V}^\mathsf{T}\rm{V})^{-1}\rm{V}^\mathsf{T}\)ã¯\((1+d) \times (2n+1)\)è¡Œåˆ—ã§ã™ã€‚\(j\)è¡Œ\((n+i+1)\)åˆ—ç›®ã®æˆåˆ†ã‚’\(f_{j}[n+i+1](i\in \{-n,-n+1,\dots,n\})\)ã¨æ›¸ãã“ã¨ã«ã™ã‚Œã°ã€ \(x=x_k\)ã«ãŠã‘ã‚‹\(j\)éšå¾®åˆ†ã¯</p> \[ P^{(j)}(x_k) = \sum_{i\in(-n,n)} f_{j}[n+i+1]y_{k+i}\] <p>ã¨ã—ã¦æ±‚ã‚ã‚‰ã‚Œã‚‹ã“ã¨ãŒåˆ†ã‹ã‚Šã¾ã™ã€‚</p> \[ \sum_{m} F(m)G(n+m) \] <p>ã¯è‡ªå·±ç›¸é–¢é–¢æ•°ã¨å‘¼ã°ã‚Œã‚‹ã‚‚ã®ã§ã€\(G\)ã®ã‹ã‚ã‚Šã«ãã‚Œã‚’é€†é †ã«ä¸¦ã¹ãŸã‚‚ã®ã‚’åˆ©ç”¨ã™ã‚Œã°ã€ç•³è¾¼ã¿ã«ãªã‚Šã¾ã™ã€‚</p> \[ \sum_{-m} F(m)G(n-m) \] <p>ãƒ‡ãƒ¼ã‚¿ç‚¹ãŒç­‰é–“éš”ã§ã‚ã‚‹ãªã‚‰ã°ã€ã©ã®\(x_k\)ã«ã¤ã„ã¦ã‚‚ã€åŒã˜\(f\)ã‚’é©ç”¨ã§ãã‚‹ã®ã§ã€ é«˜é€Ÿãƒ•ãƒ¼ãƒªã‚¨å¤‰æ›ã‚’åˆ©ç”¨ã—ãŸç•³ã¿è¾¼ã¿ç©åˆ†ã‚’åˆ©ç”¨ã§ãã¾ã™ã€‚</p> <p>ç•³ã¿è¾¼ã‚€åˆ—ãŒå°ã•ã„æ™‚ã¯ã€ç›´æ¥ç•³è¾¼ã¿ã‚’å®Ÿè¡Œã—ãŸæ–¹ãŒé€Ÿã„ãã†ã§ã™ãŒã€ã¾ãšã¯é«˜é€Ÿãƒ•ãƒ¼ãƒªã‚¨å¤‰æ›ã§å®Ÿè£…ã—ã¦ã¿ã¾ã™ã€‚ &#40;ç¶šã&#41;</p> <p> <div class="sns-container top"> <div class="sns-box b-twitter"> <a href="https://twitter.com/share?url=https://hanafsky.com/tips/savgol/&text=ãƒã‚¤ã‚ºã‚’å«ã‚€ãƒ‡ãƒ¼ã‚¿ã®å¾®åˆ† - Savitzky-Golay filter&via=HanafusaKei&related=HanafusaKei" target=_blank  rel=nofollow ><i class="fab fa-twitter"></i></a></div> <div class="sns-box b-facebook"> <a href="http://www.facebook.com/share.php?u=https://hanafsky.com/tips/savgol/" target=_blank  rel=nofollow ><i class="fab fa-facebook"></i></a></div> <div class="sns-box b-hatena"> <a href="http://b.hatena.ne.jp/add?mode=confirm&url=http://hanafsky.com/tips/savgol/&title=ãƒã‚¤ã‚ºã‚’å«ã‚€ãƒ‡ãƒ¼ã‚¿ã®å¾®åˆ† - Savitzky-Golay filter" target=_blank  rel=nofollow ><span class=icon-hatena ></span></a></div> <div class="sns-box b-pocket"> <a href="http://getpocket.com/edit?url=https://hanafsky.com/tips/savgol/&title=ãƒã‚¤ã‚ºã‚’å«ã‚€ãƒ‡ãƒ¼ã‚¿ã®å¾®åˆ† - Savitzky-Golay filter" rel=nofollow  target=_blank ><i class="fab fa-get-pocket"></i></a></div> <div class="sns-box b-feedly"> <a href='https://feedly.com/i/subscription/feed/https://hanafsky.com/tips/savgol/' target='blank' rel=nofollow ><span class=icon-feedly ></span></a></div> <div class="sns-box b-line"> <a href='https://social-plugins.line.me/lineit/share?url=https://hanafsky.com/tips/savgol/' target='blank' rel=nofollow ><span class=icon-line ></span></a></div> </div> <div class=prev-next-link > <a class=prev-link  href="https://hanafsky.com/tips/pluto"> <p class=prev-next-label >å‰ã®è¨˜äº‹</p> <p> ãƒªã‚¢ã‚¯ãƒ†ã‚£ãƒ–ãªãƒãƒ¼ãƒˆãƒ–ãƒƒã‚¯ Pluto.jl </p> </a> </div> <button onclick="topFunction()" id=myBtn  title="Go to top">Top</button> </p> <div class=page-foot > <div class=copyright > &copy; Kei Hanafusa. Last modified: March 28, 2021. Website built with <a href="https://github.com/tlienart/Franklin.jl">Franklin.jl</a> and the <a href="https://julialang.org">Julia programming language</a>. </div> </div> </div> </div> </div> <div class=page__footer > <footer> <div class=page__footer-follow > <ul class=social-icons > <li><strong>Follow:</strong> <li><a href="https://twitter.com/hanafusakei" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-twitter-square" aria-hidden=true ></i> Twitter</a> <li><a href="https://github.com/hanafsky" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-github" aria-hidden=true ></i> GitHub</a> </ul> </div> <div class=page__footer-copyright >&copy; Kei Hanafusa. Powered by <a href="https://github.com/tlienart/Franklin.jl">Franklin</a> &amp; <a href="https://mademistakes.com/work/minimal-mistakes-jekyll-theme/" rel=nofollow >Minimal Mistakes</a>.</div> </footer> </div> <script src="/libs/minimal-mistakes/main.min.js"></script> <script defer src="https://use.fontawesome.com/releases/v5.8.2/js/all.js" integrity="sha384-DJ25uNYET2XCl5ZF++U8eNxPWqcKohUUBUpKGlNLMchM7q4Wjg2CUpjHLaL8yYPH" crossorigin=anonymous ></script> <script src="/libs/myBtn/myBtn.js"></script> <script src="/libs/luminous/Luminous.min.js"></script> <script src="/libs/katex/katex.min.js"></script> <script src="/libs/katex/auto-render.min.js"></script> <script>renderMathInElement(document.body)</script> <script src="/libs/highlight/highlight.pack.js"></script> <script>hljs.initHighlightingOnLoad();hljs.configure({tabReplace: ' '});</script> <script> new Luminous(document.querySelectorAll('.zoom')); </script> <script> function myToc() { var x = document.getElementsByClassName("mytoc"); if (x.style.display === "none") { x.style.display = "block"; } else { x.style.display = "none"; } } </script>