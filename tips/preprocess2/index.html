<!doctype html> <!-- Minimal Mistakes Jekyll Theme 4.16.4 by Michael Rose Copyright 2013-2019 Michael Rose - mademistakes.com | @mmistakes Free for personal and commercial use under the MIT license https://github.com/mmistakes/minimal-mistakes/blob/master/LICENSE --> <html lang=ja > <meta charset=UTF-8 > <meta name=viewport  content="width=device-width, initial-scale=1"> <link rel=stylesheet  href="/libs/highlight/github.min.css"> <link rel=stylesheet  href="/css/franklin.css"> <link rel=stylesheet  href="/css/minimal-mistakes.css"> <link rel=stylesheet  href="/css/adjust.css"> <link rel=stylesheet  href="/css/luminous-basic.min.css"> <link rel=icon  href="/assets/favicon.ico"> <!--[if IE ]> <style> /* old IE unsupported flexbox fixes */ .greedy-nav .site-title { padding-right: 3em; } .greedy-nav button { position: absolute; top: 0; right: 0; height: 100%; } </style> <![endif]--> <title>Awesome ãªå‰å‡¦ç†</title> <body class=layout--single > <div class=masthead > <div class=masthead__inner-wrap > <div class=masthead__menu > <nav id=site-nav  class=greedy-nav > <a class=site-title  href="/">Hanafsky.com</a> <ul class=visible-links > <li class=masthead__menu-item ><a href="/tips/" >Julia-tips</a> <li class=masthead__menu-item ><a href="/blog/" >Blog</a> <li class=masthead__menu-item ><a href="/project/" >Projects</a> <li class=masthead__menu-item ><a href="/about/">About</a> </ul> <button class="greedy-nav__toggle hidden" type=button > <span class=visually-hidden >Toggle menu</span> <div class=navicon ></div> </button> <ul class="hidden-links hidden"></ul> </nav> </div> </div> </div> <div class=initial-content > <div id=main  role=main > <div class="sidebar sticky"> <div itemscope itemtype="https://schema.org/Person"> <div class=author__avatar > <img src="/assets/design/author3.png" alt=Dio  itemprop=image > </div> <div class=author__content > <h3 class=author__name  itemprop=name >Kei Hanafusa</h3> <p class=author__bio  itemprop=description >Chemical Engineer, <br> living in Osaka, ğŸ—¾</p> </div> <div class=author__urls-wrapper > <button class="btn btn--inverse">Follow</button> <ul class="author__urls social-icons"> <li itemprop=homeLocation  itemscope itemtype="https://schema.org/Place"> <i class="fas fa-fw fa-map-marker-alt" aria-hidden=true ></i> <span itemprop=name >Osaka, Japan</span> <li><a href="https://twitter.com/hanafusakei" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-twitter-square" aria-hidden=true ></i> Twitter</a> <li><a href="https://github.com/lethal8723" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-github" aria-hidden=true ></i> GitHub</a> </ul> </div> <div class=author__urls-wrapper > <button class="btn btn--inverse">Tag</button> <ul class="author__urls social-icons"> <li>ã‚¿ã‚° <li> <li><a href="/tag/setting/">è¨­å®š</a> <li><a href="/tag/thirdparty/">ã‚µãƒ¼ãƒ‰ãƒ‘ãƒ¼ãƒ†ã‚£ãƒ©ã‚¤ãƒ–ãƒ©ãƒª</a> <li><a href="/tag/recipe">ãƒ¬ã‚·ãƒ”</a> </ul> </div> </div> </div> <div class=franklin-content ><h1 id="awesome_ãªå‰å‡¦ç†_2"><a href="#awesome_ãªå‰å‡¦ç†_2" class=header-anchor >Awesome ãªå‰å‡¦ç† 2</a></h1> <p>å‰å‡¦ç†å¤§å…¨ã®juliaç‰ˆãã®2ã§ã™ã€‚ ã¾ãšã¯ã€ãƒ›ãƒ†ãƒ«ã®äºˆç´„ãƒ‡ãƒ¼ã‚¿ã‚’èª­ã¿è¾¼ã¿ã¾ã™ã€‚</p> <pre><code class="julia hljs"><span class=hljs-keyword >using</span> DataFrames,CSV
path = joinpath(<span class=hljs-string >&quot;tips&quot;</span>,<span class=hljs-string >&quot;data&quot;</span>,<span class=hljs-string >&quot;reserve.csv&quot;</span>)
reserve_df = CSV.read(path,DataFrame)
<span class=hljs-comment >#first(reserve_df) |&gt; println</span></code></pre> <div class=code-output ><pre><code class="plaintext hljs">ArgumentError: Package CSV not found in current path:
- Run `import Pkg; Pkg.add(&quot;CSV&quot;)` to install the CSV package.

</code></pre></div> <h2><div class=mytoc >ç›®æ¬¡ <div class=franklin-toc ><ol><li><a href="#3_é›†ç´„">3 é›†ç´„</a><ol><li><a href="#3-1_ãƒ‡ãƒ¼ã‚¿æ•°ç¨®é¡æ•°ã®ç®—å‡º">3-1 ãƒ‡ãƒ¼ã‚¿æ•°ã€ç¨®é¡æ•°ã®ç®—å‡º</a><li><a href="#3-2_åˆè¨ˆå€¤ã®ç®—å‡º">3-2 åˆè¨ˆå€¤ã®ç®—å‡º</a><li><a href="#3-3_æ¥µå€¤ä»£è¡¨å€¤ã®ç®—å‡º">3-3 æ¥µå€¤ã€ä»£è¡¨å€¤ã®ç®—å‡º</a><li><a href="#3-4_ã°ã‚‰ã¤ãå…·åˆã®ç®—å‡º">3-4 ã°ã‚‰ã¤ãå…·åˆã®ç®—å‡º</a><li><a href="#3-5_æœ€é »å€¤ã®ç®—å‡º">3-5 æœ€é »å€¤ã®ç®—å‡º</a><li><a href="#3-6_é †ä½ã®ç®—å‡º">3-6 é †ä½ã®ç®—å‡º</a><li><a href="#q_ãƒ©ãƒ³ã‚­ãƒ³ã‚°">Q ãƒ©ãƒ³ã‚­ãƒ³ã‚°</a></ol></ol></div></div></h2> <h2 id="3_é›†ç´„"><a href="#3_é›†ç´„" class=header-anchor >3 é›†ç´„</a></h2> <h3 id="3-1_ãƒ‡ãƒ¼ã‚¿æ•°ç¨®é¡æ•°ã®ç®—å‡º"><a href="#3-1_ãƒ‡ãƒ¼ã‚¿æ•°ç¨®é¡æ•°ã®ç®—å‡º" class=header-anchor >3-1 ãƒ‡ãƒ¼ã‚¿æ•°ã€ç¨®é¡æ•°ã®ç®—å‡º</a></h3> <p>ãƒ›ãƒ†ãƒ«ã”ã¨ã«äºˆç´„æ•°ã€é¡§å®¢æ•°ã®é›†è¨ˆã‚’è¡Œã†ç·´ç¿’ã§ã™ã€‚ ãƒ›ãƒ†ãƒ«ã”ã¨ã«ãƒ‡ãƒ¼ã‚¿ã‚’åˆ†ã‘ã‚‹å‡¦ç†ã¯ã€groupbyé–¢æ•°ã§å®Ÿæ–½ã—ã¾ã™ã€‚</p> <p>groupbyé–¢æ•°ã¯ã€<code>groupby&#40;df::AbstractDataFrame,cols;kwargs...&#41;</code> ã®ã‚ˆã†ã«ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ¬ãƒ¼ãƒ ã¨åˆ—åã‚’å¼•æ•°ã—ã¦ã€è¿”ã‚Šå€¤ã¯<code>GroupedDataFrame</code>ã¨ãªã‚Šã¾ã™ã€‚</p> <p>ã‚°ãƒ«ãƒ¼ãƒ—åŒ–ã—ãŸãƒ‡ãƒ¼ã‚¿æ¯ã«é›†è¨ˆã™ã‚‹å‡¦ç†ã¯combineé–¢æ•°ã§å®Ÿæ–½ã—ã¾ã™ã€‚ combineé–¢æ•°ã¯ã€<code>GroupedDataFrame</code>ã‚’å¼•æ•°ã«ã—ã¦ã€ã•ã‚‰ã« <code>åˆ—å &#61;&gt; é–¢æ•° &#40;&#61;&gt; æ–°ã—ã„åˆ—å&#41;</code>ã®ã‚ˆã†ãªæ›¸ãæ–¹ã®å¯å¤‰é•·å¼•æ•°ã‚’ã¨ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚</p> <p>ã“ã®å•é¡Œã¯ã€@chainãƒã‚¯ãƒ­ã‚’ç”¨ã„ãŸãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³å‡¦ç†ã«ã‚ˆã£ã¦ã€ä»¥ä¸‹ã®ã‚ˆã†ã«ã€ç°¡æ½”ã«è¨˜è¿°ã§ãã¾ã™ã€‚</p> <pre><code class="julia hljs"><span class=hljs-keyword >using</span> Chain
df3_1= <span class=hljs-meta >@chain</span> reserve_df <span class=hljs-keyword >begin</span>
  groupby(:hotel_id)
  combine(:reserve_id  =&gt; length        =&gt; :rsv_cnt,
          :customer_id =&gt; lengthâˆ˜unique =&gt; :cus_cnt)
<span class=hljs-keyword >end</span>
first(df3_1) |&gt; println</code></pre> <div class=code-output ><pre><code class="plaintext hljs">UndefVarError: reserve_df not defined
</code></pre></div> <p>äºˆç´„æ•°ã¯ã€lengthé–¢æ•°ã§é›†è¨ˆå¯èƒ½ã§ã™ã€‚ é¡§å®¢æ•°ã‚’é›†è¨ˆã™ã‚‹ã«ã¯ã€é¡§å®¢åã®é‡è¤‡ã‚’æ¶ˆã™ãŸã‚ã«ã€uniqueé–¢æ•°ã¨lengthé–¢æ•°ã‚’åˆæˆã—ãŸé–¢æ•°ã‚’åˆ©ç”¨ã—ã¾ã—ãŸã€‚</p> <p>uniqueé–¢æ•°ã¨lengthé–¢æ•°ã‚’çµ„ã¿åˆã‚ã›ã‚‹æ›¸ãæ–¹ã¯å‰å‡¦ç†å¤§å…¨ã§ã¯æ¨å¥¨ã•ã‚Œã¦ã„ãªã„æ›¸ãæ–¹ã§ã™ãŒã€ ã“ã®ä¾‹ã§ã¯å¯èª­æ€§ãŒååˆ†é«˜ãã€å‡¦ç†é€Ÿåº¦ã‚‚ãŠãã‚‰ãå•é¡Œã«ãªã‚‰ãªã„ã§ã—ã‚‡ã†ã‹ã‚‰Awesomeã¨ã„ã†ã“ã¨ã«ã—ã¾ã™ã€‚</p> <h3 id="3-2_åˆè¨ˆå€¤ã®ç®—å‡º"><a href="#3-2_åˆè¨ˆå€¤ã®ç®—å‡º" class=header-anchor >3-2 åˆè¨ˆå€¤ã®ç®—å‡º</a></h3> <p>ãƒ›ãƒ†ãƒ«ã¨å®¿æ³Šäººæ•°æ¯ã«é›†è¨ˆã—ã¦ã¿ã¾ã™ã€‚è¤‡æ•°ã®åˆ—ã«ã¤ã„ã¦ã‚°ãƒ«ãƒ¼ãƒ—åˆ†ã‘ã—ã¦é›†è¨ˆã‚’è¡Œã†å ´åˆã¯ã€<code>:hote_id</code>ã¨<code>:people_num</code>ã‚’Arrayã¨ã—ã¦ã€ groupbyé–¢æ•°ã®å¼•æ•°ã«ã™ã‚Œã°OKã§ã™ã€‚ ã¾ãŸã€ã‚°ãƒ«ãƒ¼ãƒ—ã”ã¨ã«åˆ—ã®åˆè¨ˆå€¤ã‚’å‡ºåŠ›ã™ã‚‹ã«ã¯ã€sumé–¢æ•°ã‚’æŒ‡å®šã™ã‚Œã°ã‚ˆã„ã§ã™ã€‚</p> <pre><code class="julia hljs">df3_2 = <span class=hljs-meta >@chain</span> reserve_df <span class=hljs-keyword >begin</span>
  groupby([:hotel_id,:people_num])
  combine(:total_price=&gt; sum =&gt;:price_sum)
<span class=hljs-keyword >end</span>
first(df3_2) |&gt; println</code></pre> <div class=code-output ><pre><code class="plaintext hljs">UndefVarError: reserve_df not defined
</code></pre></div> <h3 id="3-3_æ¥µå€¤ä»£è¡¨å€¤ã®ç®—å‡º"><a href="#3-3_æ¥µå€¤ä»£è¡¨å€¤ã®ç®—å‡º" class=header-anchor >3-3 æ¥µå€¤ã€ä»£è¡¨å€¤ã®ç®—å‡º</a></h3> <p>ãƒ›ãƒ†ãƒ«æ¯ã«total_priceåˆ—ã®æœ€å¤§å€¤ã€æœ€å°å€¤ã€å¹³å‡å€¤ã€ä¸­å¤®å€¤ã€20&#37;ã®ãƒ‘ãƒ¼ã‚»ãƒ³ã‚¿ã‚¤ãƒ«ã‚’å‡ºåŠ›ã—ã¾ã™ã€‚ å¹³å‡å€¤ã€ä¸­å¤®å€¤ã€ãƒ‘ãƒ¼ã‚»ãƒ³ã‚¿ã‚¤ãƒ«ã®å‡ºåŠ›ã«ã¯ã€æ–°ãŸãªé–¢æ•°ãŒå¿…è¦ãªã®ã§ã€Statistics.jlã‚’å°å…¥ã—ã¾ã™ã€‚ ãƒ‘ãƒ¼ã‚»ãƒ³ã‚¿ã‚¤ãƒ«ã¯ã€ç„¡åé–¢æ•°ã‚’ä½¿ç”¨ã™ã‚‹ãŸã‚ã€ã‚„ã‚„å†—é•·ãªæ›¸ãæ–¹ã¨ãªã£ã¦ã„ã¾ã™ã€‚</p> <pre><code class="julia hljs"><span class=hljs-keyword >using</span> Statistics
<span class=hljs-meta >@chain</span> reserve_df <span class=hljs-keyword >begin</span>
  groupby(:hotel_id)
  combine(:total_price=&gt;maximum=&gt;:price_max,
          :total_price=&gt;minimum=&gt;:price_min,
          :total_price=&gt;mean=&gt;:price_mean, 
          :total_price=&gt;median=&gt;:price_medeian,
          :total_price=&gt;(r-&gt;quantile(r,<span class=hljs-number >0.2</span>))=&gt;:price_20per) 
  first(<span class=hljs-number >10</span>)
  println
<span class=hljs-keyword >end</span></code></pre> <div class=code-output ><pre><code class="plaintext hljs">UndefVarError: reserve_df not defined
</code></pre></div> <h3 id="3-4_ã°ã‚‰ã¤ãå…·åˆã®ç®—å‡º"><a href="#3-4_ã°ã‚‰ã¤ãå…·åˆã®ç®—å‡º" class=header-anchor >3-4 ã°ã‚‰ã¤ãå…·åˆã®ç®—å‡º</a></h3> <p>åˆ†æ•£ã‚„æ¨™æº–åå·®ã¯ã€å¹³å‡åŒæ§˜ã«Statistics.jlã‚’usingã™ã‚Œã°ä½¿ãˆã¾ã™ã€‚ åˆ†æ•£ã‚„æ¨™æº–åå·®ã¯ã€ãƒ‡ãƒ¼ã‚¿æ•°ãŒ1ã¤ã—ã‹ãªã„å ´åˆã«ã¯NaNï¼ˆNot a Numberï¼‰ã‚’è¿”ã—ã¾ã™ã€‚</p> <pre><code class="julia hljs"><span class=hljs-keyword >using</span> Statistics
<span class=hljs-meta >@show</span> var([<span class=hljs-number >1</span>,<span class=hljs-number >5</span>,<span class=hljs-number >9</span>])
<span class=hljs-meta >@show</span> std([<span class=hljs-number >1</span>,<span class=hljs-number >5</span>,<span class=hljs-number >9</span>])
<span class=hljs-meta >@show</span> var([<span class=hljs-number >1</span>])
<span class=hljs-meta >@show</span> std([<span class=hljs-number >1</span>])</code></pre> <div class=code-output ><pre><code class="plaintext hljs">var([1, 5, 9]) = 16.0
std([1, 5, 9]) = 4.0
var([1]) = NaN
std([1]) = NaN
</code></pre></div> <p>varã¨stdã«ã¤ã„ã¦NaNã‚’0ã«å¤‰æ›´ã™ã‚‹æ–¹æ³•ã‚’èª¿æŸ»ã—ã¾ã—ãŸã€‚ã„ãã¤ã‹æ–¹æ³•ã¯ã‚ã‚Šã¾ã—ãŸãŒã€ <code>ifelse&#40;isnan&#40;x&#41;,0,x&#41;</code>ã¨ã„ã†é–¢æ•°ã‚’ä½¿ã†ã®ãŒä¸€ç•ªçŸ­ãæ›¸ã‘ãã†ã§ã™ã€‚ &#40;Rç‰ˆã®å›ç­”ã«ã‚ã‚‹coalesceé–¢æ•°ã¯juliaã«ã‚‚ã‚ã‚Šã¾ã™ãŒã€æ©Ÿèƒ½ãŒç•°ãªã‚‹ã‚ˆã†ã§ã™ã€‚&#41;</p> <p>NaNã‚’0ã«ç½®ãæ›ãˆã‚‹å‡¦ç†ã¯ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³å‡¦ç†ã®ä¸­ã§ç„¡åé–¢æ•°ã‚’ä½¿ã£ã¦å®Ÿè£…ã™ã‚‹ã“ã¨ã‚‚ã§ãã¾ã™ãŒã€ å¯èª­æ€§ã¯ä½ã„ã®ã§ã€ãƒ–ãƒ­ãƒ¼ãƒ‰ã‚­ãƒ£ã‚¹ãƒˆæ¼”ç®—ã§æœ€å¾Œã«ã¾ã¨ã‚ã¦å‡¦ç†ã™ã‚‹ã®ãŒAwesomeã§ã—ã‚‡ã†ã€‚</p> <pre><code class="julia hljs"><span class=hljs-keyword >using</span> Chain,Statistics,DataFrames
df3_4=<span class=hljs-meta >@chain</span> DataFrame(a=[<span class=hljs-string >&quot;ã‚&quot;</span>,<span class=hljs-string >&quot;ã‚&quot;</span>,<span class=hljs-string >&quot;ã„&quot;</span>],b=[<span class=hljs-number >1</span>,<span class=hljs-number >2</span>,<span class=hljs-number >3</span>]) <span class=hljs-keyword >begin</span>
  groupby(:a)
  combine(:b=&gt;sum,
          :b=&gt;(r-&gt;ifelse(isnan(var(r)),<span class=hljs-number >0</span>,var(r))) =&gt;:b_var,
          :b=&gt;std)
<span class=hljs-keyword >end</span>
<span class=hljs-meta >@show</span> df3_4
df = df3_4[!,<span class=hljs-number >2</span>:<span class=hljs-keyword >end</span>] <span class=hljs-comment >#ï¼’åˆ—ç›®ä»¥é™ã®viewã‚’ä½œæˆã€‚ï¼‘åˆ—ç›®ã«isnanã‚’é©ç”¨ã™ã‚‹ã¨ã‚¨ãƒ©ãƒ¼ãŒã‹ãˆã£ã¦æ¥ã¾ã™ã€‚</span>
df .= ifelse.(isnan.(df),<span class=hljs-number >0</span>,df) <span class=hljs-comment >#ãƒ–ãƒ­ãƒ¼ãƒ‰ã‚­ãƒ£ã‚¹ãƒˆæ¼”ç®—</span>
println()
<span class=hljs-meta >@show</span> df3_4</code></pre> <div class=code-output ><pre><code class="plaintext hljs">df3_4 = 2Ã—4 DataFrame
 Row â”‚ a       b_sum  b_var    b_std
     â”‚ String  Int64  Float64  Float64
â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   1 â”‚ ã‚          3      0.5    0.707107
   2 â”‚ ã„          3      0.0  NaN

df3_4 = 2Ã—4 DataFrame
 Row â”‚ a       b_sum  b_var    b_std
     â”‚ String  Int64  Float64  Float64
â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   1 â”‚ ã‚          3      0.5  0.707107
   2 â”‚ ã„          3      0.0  0.0
</code></pre></div> <p>ã“ã®æ–¹æ³•ã‚’ä¾‹é¡Œã«é©ç”¨ã™ã‚‹ã¨ä»¥ä¸‹ã®ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚</p> <pre><code class="julia hljs">df3_4=<span class=hljs-meta >@chain</span> reserve_df <span class=hljs-keyword >begin</span> 
  groupby(:hotel_id)
  combine(:total_price=&gt;var,
          :total_price=&gt;std)
<span class=hljs-keyword >end</span>
df = df3_4[!,<span class=hljs-number >2</span>:<span class=hljs-keyword >end</span>] <span class=hljs-comment >#ï¼’åˆ—ç›®ä»¥é™ã®viewã‚’ä½œæˆã€‚ï¼‘åˆ—ç›®ã«isnanã‚’é©ç”¨ã™ã‚‹ã¨ã‚¨ãƒ©ãƒ¼ãŒã‹ãˆã£ã¦æ¥ã¾ã™ã€‚</span>
df .= ifelse.(isnan.(df),<span class=hljs-number >0</span>,df) <span class=hljs-comment >#ãƒ–ãƒ­ãƒ¼ãƒ‰ã‚­ãƒ£ã‚¹ãƒˆæ¼”ç®—</span>
<span class=hljs-meta >@show</span> first(df3_4,<span class=hljs-number >10</span>)</code></pre> <div class=code-output ><pre><code class="plaintext hljs">UndefVarError: reserve_df not defined
</code></pre></div> <div class=note ><div class=title >ğŸ˜² Note</div> <div class=content >å‰å‡¦ç†å¤§å…¨ã®è‘—è€…ã«ã‚ˆã‚Œã°ã€ãƒ‡ãƒ¼ã‚¿ã¯ãƒ‘ãƒ¼ãƒˆãƒŠãƒ¼ã®å¿ƒã¨åŒæ§˜ã«ä¸å®‰å®šã§ã°ã‚‰ã¤ããŒã‚ã‚‹ã‚‚ã®ã ãã†ã§ã™ã€‚ åˆ†æ•£å€¤/æ¨™æº–åå·®å€¤ã¨ãƒ‘ãƒ¼ãƒˆãƒŠãƒ¼ã®æ°—æŒã¡ã‚’å¸¸ã€…æ°—ã«ã‹ã‘ãŸã„ã¨æ€ã„ã¾ã™ã€‚</div></div> <h3 id="3-5_æœ€é »å€¤ã®ç®—å‡º"><a href="#3-5_æœ€é »å€¤ã®ç®—å‡º" class=header-anchor >3-5 æœ€é »å€¤ã®ç®—å‡º</a></h3> <p><code>:total_price</code>ã‚’100ã®ä½ã‚’å››æ¨äº”å…¥ã—ã¦ã€æœ€é »å€¤ã‚’æ±‚ã‚ã¾ã™ã€‚ å››æ¨äº”å…¥ã¯roundé–¢æ•°ã§å®Ÿè¡Œã§ãã¾ã™ãŒã€ä¸¸ã‚ã‚‹æ¡ã¯ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰å¼•æ•°digitsã§æŒ‡å®šã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚ StatsBase.jlã‚’ã‚¤ãƒ³ãƒãƒ¼ãƒˆã—ã¦ãŠã‘ã°ã€pythonã¨åŒã˜ãmodeé–¢æ•°ã§æœ€é »å€¤ã‚’æ±‚ã‚ã‚‹ã“ã¨ãŒå¯èƒ½ã§ã™ã€‚</p> <pre><code class="julia hljs"><span class=hljs-keyword >using</span> StatsBase
mode(round.(reserve_df.total_price, digits=-<span class=hljs-number >3</span>)) |&gt; println</code></pre> <div class=code-output ><pre><code class="plaintext hljs">UndefVarError: reserve_df not defined
</code></pre></div> <p>2ä¸‡å††ãã‚‰ã„ãƒ›ãƒ†ãƒ«ã«ãŠé‡‘ã‚’è½ã¨ã—ã¦ã„ã‚‹äººãŒä¸€ç•ªå¤šã„ã¨ã„ã†ã“ã¨ã§ã™ã­ã€‚</p> <h3 id="3-6_é †ä½ã®ç®—å‡º"><a href="#3-6_é †ä½ã®ç®—å‡º" class=header-anchor >3-6 é †ä½ã®ç®—å‡º</a></h3> <p>ãƒ›ãƒ†ãƒ«ã”ã¨ã«äºˆç´„æ—¥æ™‚é †ã®ç•ªå·ä»˜ã‘ã‚’ã—ã¦ã¿ã¾ã™ã€‚ ãã‚‚ãã‚‚äºˆç´„æ—¥æ™‚ãŒStringå‹ã¨ã—ã¦èªè­˜ã•ã‚Œã¦ã„ã‚‹ã®ã§ã€ã¾ãšã¯DateTimeå‹ã«ãƒ‘ãƒ¼ã‚¹ã—ã¾ã™ã€‚</p> <pre><code class="julia hljs"><span class=hljs-keyword >using</span> Dates
reserve_df.reserve_datetime = DateTime.(reserve_df.reserve_datetime,<span class=hljs-string >dateformat&quot;y-m-d HH:MM:SS&quot;</span>)
reserve_df |&gt; first |&gt; println</code></pre> <div class=code-output ><pre><code class="plaintext hljs">UndefVarError: reserve_df not defined
</code></pre></div> <p>ãƒ©ãƒ³ã‚­ãƒ³ã‚°ä»˜ã‘ã«å¯¾å¿œã™ã‚‹é–¢æ•°ã¯StatsBase.jlã«ç”¨æ„ã•ã‚Œã¦ã„ã¾ã™ã€‚</p> <table><tr><th align=right >é–¢æ•°å<th align=right >è¡¨ç¤ºæ³•<tr><td align=right >ordinalrank<td align=right >1234<tr><td align=right >competerank<td align=right >1223<tr><td align=right >denserank<td align=right >1223<tr><td align=right >tiedrank<td align=right >1 2.5 2.5 4</table> <p>ãƒ©ãƒ³ã‚­ãƒ³ã‚°æ–¹æ³•ã«ã‚‚ã„ãã¤ã‹ç¨®é¡ãŒã‚ã‚Šã¾ã™ãŒã€æ—¥æ™‚ãŒå®Œå…¨ã«ä¸€è‡´ã™ã‚‹ã“ã¨ã¯ãªã„ã§ã—ã‚‡ã†ã‹ã‚‰ã€ ã“ã“ã§ã¯<code>ordinalrank</code>ã‚’åˆ©ç”¨ã—ã¾ã™ã€‚</p> <p>å‰å‡¦ç†ã®æ‰‹é †ã¨ã—ã¦ã¯ã€groupbyé–¢æ•°ã§hotel_idæ¯ã«ãƒ‡ãƒ¼ã‚¿ã‚’åˆ†ã‘ã¦ã€selecté–¢æ•°ã§å¿…è¦ãªåˆ—ã‚’é¸ã³ã¾ã™ã€‚</p> <p>selecté–¢æ•°ã®å¼•æ•°ã¯<code>:åˆ—å &#61;&gt; å‡¦ç† &#61;&gt; :æ–°ã—ã„åˆ—å</code>ã¨ã„ã†ã‚ˆã†ã«combineé–¢æ•°ã¨åŒã˜ã‚ˆã†ãªä¸ãˆæ–¹ãŒå¯èƒ½ã§ã™ã€‚ ã§ã¯ã‚„ã£ã¦ã¿ã¾ã™ã€‚</p> <pre><code class="julia hljs"><span class=hljs-keyword >using</span> StatsBase
<span class=hljs-meta >@chain</span> reserve_df <span class=hljs-keyword >begin</span>
  groupby(:hotel_id)
  select(:,:reserve_datetime =&gt; ordinalrank =&gt;:log_no)
  first(<span class=hljs-number >10</span>)
  println
<span class=hljs-keyword >end</span></code></pre> <p><div class=code-output ><pre><code class="plaintext hljs">UndefVarError: reserve_df not defined
</code></pre></div> ä¸€ç•ªå³ã®åˆ—ã«<code>:log_no</code>ã®åˆ—ãŒè¿½åŠ ã•ã‚Œã¦ã„ã‚‹ã“ã¨ãŒç¢ºèªã§ãã¾ã™ã€‚</p> <h3 id="q_ãƒ©ãƒ³ã‚­ãƒ³ã‚°"><a href="#q_ãƒ©ãƒ³ã‚­ãƒ³ã‚°" class=header-anchor >Q ãƒ©ãƒ³ã‚­ãƒ³ã‚°</a></h3> <p>ãƒ›ãƒ†ãƒ«æ¯ã«äºˆç´„æ•°ã‚’é›†è¨ˆã—ã¦ã€ãƒ©ãƒ³ã‚­ãƒ³ã‚°ä»˜ã‘ã‚’è¡Œã„ã¾ã™ã€‚åŒã˜äºˆç´„æ•°ã®å ´åˆã¯ã€ æœ€å°ã®é †ä½ã‚’ä»˜ã‘ã‚‹ã“ã¨ã«ãªã£ã¦ã„ã‚‹ã®ã§ã€ordinalrankã§ã¯ãªãã¦ã€competerankã‚’åˆ©ç”¨ã—ã¾ã™ã€‚</p> <pre><code class="julia hljs"><span class=hljs-meta >@chain</span> reserve_df <span class=hljs-keyword >begin</span>
  groupby(:hotel_id)
  combine(:reserve_id =&gt; length =&gt; :rsv_cnt)
  select(:,:rsv_cnt =&gt; competerank =&gt;:rsv_cnt_rank)
  first(<span class=hljs-number >10</span>)
  println
<span class=hljs-keyword >end</span></code></pre> <div class=code-output ><pre><code class="plaintext hljs">UndefVarError: reserve_df not defined
</code></pre></div> <p> <div class=prev-next-link > <a class=prev-link  href=" /tips/preprocess1"> <p class=prev-next-label >å‰ã®è¨˜äº‹</p> <p> Awesome ãªå‰å‡¦ç†1 </p> </a> <a class=next-link  href=" /tips/preprocess3"> <p class=prev-next-label >æ¬¡ã®è¨˜äº‹</p> <p> Awesome ãªå‰å‡¦ç†3 </p> </a> </div> <button onclick="topFunction()" id=myBtn  title="Go to top">Top</button> </p> <div class=page-foot > <div class=copyright > &copy; Kei Hanafusa. Last modified: March 05, 2021. Website built with <a href="https://github.com/tlienart/Franklin.jl">Franklin.jl</a> and the <a href="https://julialang.org">Julia programming language</a>. </div> </div> </div> </div> </div> <div class=page__footer > <footer> <div class=page__footer-follow > <ul class=social-icons > <li><strong>Follow:</strong> <li><a href="https://twitter.com/hanafusakei" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-twitter-square" aria-hidden=true ></i> Twitter</a> <li><a href="https://github.com/lethal8723" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-github" aria-hidden=true ></i> GitHub</a> </ul> </div> <div class=page__footer-copyright >&copy; Kei Hanafusa. Powered by <a href="https://github.com/tlienart/Franklin.jl">Franklin</a> &amp; <a href="https://mademistakes.com/work/minimal-mistakes-jekyll-theme/" rel=nofollow >Minimal Mistakes</a>.</div> </footer> </div> <script src="/libs/minimal-mistakes/main.min.js"></script> <script defer src="https://use.fontawesome.com/releases/v5.8.2/js/all.js" integrity="sha384-DJ25uNYET2XCl5ZF++U8eNxPWqcKohUUBUpKGlNLMchM7q4Wjg2CUpjHLaL8yYPH" crossorigin=anonymous ></script> <script src="/libs/myBtn/myBtn.js"></script> <script src="/libs/luminous/Luminous.min.js"></script> <script> new Luminous(document.querySelectorAll('.zoom')); </script> <script> function myToc() { var x = document.getElementsByClassName("mytoc"); if (x.style.display === "none") { x.style.display = "block"; } else { x.style.display = "none"; } } </script>