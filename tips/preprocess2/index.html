<!doctype html>
<!--
  Minimal Mistakes Jekyll Theme 4.16.4 by Michael Rose
  Copyright 2013-2019 Michael Rose - mademistakes.com | @mmistakes
  Free for personal and commercial use under the MIT license
  https://github.com/mmistakes/minimal-mistakes/blob/master/LICENSE
-->
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  
   <link rel="stylesheet" href="/libs/highlight/github.min.css">
   
  <link rel="stylesheet" href="/css/franklin.css">
<link rel="stylesheet" href="/css/minimal-mistakes.css">
<link rel="stylesheet" href="/css/adjust.css">
<link rel="stylesheet" href="/css/luminous-basic.min.css">
<link rel="icon" href="/assets/favicon.ico">
<link href="https://use.fontawesome.com/releases/v5.6.1/css/all.css" rel="stylesheet">
<!-- <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css"> -->

<!--[if IE ]>
<style>
  /* old IE unsupported flexbox fixes */
  .greedy-nav .site-title {
    padding-right: 3em;
  }
  .greedy-nav button {
    position: absolute;
    top: 0;
    right: 0;
    height: 100%;
  }
</style>
<![endif]-->

   <title>Awesome ãªå‰å‡¦ç†</title>  
  <!-- end custom head snippets -->
</head>
<body class="layout--single">
  <div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        <a class="site-title" href="/">Hanafsky.com</a>
        <ul class="visible-links">
          <li class="masthead__menu-item"><a href="/tips/" >Julia-tips</a></li>
          <li class="masthead__menu-item"><a href="/blog/" >Blog</a></li>
          <li class="masthead__menu-item"><a href="/project/" >Projects</a></li>
          <li class="masthead__menu-item"><a href="/about/">About</a></li>
        </ul>
        <button class="greedy-nav__toggle hidden" type="button">
          <span class="visually-hidden">Toggle menu</span>
          <div class="navicon"></div>
        </button>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>

  <div class="initial-content">
    <div id="main" role="main">
      <div class="sidebar sticky">
        <div itemscope itemtype="https://schema.org/Person">
          <div class="author__avatar">
            <img src="/assets/design/author3.png" alt="Dio" itemprop="image">
          </div>
          <div class="author__content">
            <h3 class="author__name" itemprop="name">Kei Hanafusa</h3>
            <p class="author__bio" itemprop="description">Chemical Engineer, <br> living in Osaka, ğŸ—¾</p>
          </div>
          <div class="author__urls-wrapper">
            <button class="btn btn--inverse">Follow</button>
            <ul class="author__urls social-icons">
              <li itemprop="homeLocation" itemscope itemtype="https://schema.org/Place">
                <i class="fas fa-fw fa-map-marker-alt" aria-hidden="true"></i> <span itemprop="name">Osaka, Japan</span></li>
              <li><a href="https://twitter.com/hanafusakei" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-twitter-square" aria-hidden="true"></i> Twitter</a></li>
              <li><a href="https://github.com/hanafsky" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-github" aria-hidden="true"></i> GitHub</a></li>
            </ul>
          </div>

          
          
              

          <div class="author__urls-wrapper">
            <button class="btn btn--inverse">Tag</button>
            <ul class="author__urls social-icons">
              <li>ã‚¿ã‚°</li>
              <li></li>
              <li><a href="/tag/setting/">è¨­å®š</a></li>
              <li><a href="/tag/thirdparty/">ã‚µãƒ¼ãƒ‰ãƒ‘ãƒ¼ãƒ†ã‚£ãƒ©ã‚¤ãƒ–ãƒ©ãƒª</a></li>
              <li><a href="/tag/recipe">ãƒ¬ã‚·ãƒ”</a></li>
            </ul>
          </div>
          
        </div>
      </div>


<!-- Content appended here -->
<div class="franklin-content"><h1 id="awesome_ãªå‰å‡¦ç†_2"><a href="#awesome_ãªå‰å‡¦ç†_2" class="header-anchor">Awesome ãªå‰å‡¦ç† 2</a></h1>
<p>å‰å‡¦ç†å¤§å…¨ã®juliaç‰ˆãã®2ã§ã™ã€‚ ã¾ãšã¯ã€ãƒ›ãƒ†ãƒ«ã®äºˆç´„ãƒ‡ãƒ¼ã‚¿ã‚’èª­ã¿è¾¼ã¿ã¾ã™ã€‚</p>
<pre><code class="language-julia">using DataFrames,CSV
path &#61; joinpath&#40;&quot;tips&quot;,&quot;data&quot;,&quot;reserve.csv&quot;&#41;
reserve_df &#61; CSV.read&#40;path,DataFrame&#41;
#first&#40;reserve_df&#41; |&gt; println</code></pre>
<div class="code-output"></div>
<div class="franklin-toc"><ol><li><a href="#3_é›†ç´„">3 é›†ç´„</a><ol><li><a href="#3-1_ãƒ‡ãƒ¼ã‚¿æ•°ç¨®é¡æ•°ã®ç®—å‡º">3-1 ãƒ‡ãƒ¼ã‚¿æ•°ã€ç¨®é¡æ•°ã®ç®—å‡º</a></li><li><a href="#3-2_åˆè¨ˆå€¤ã®ç®—å‡º">3-2 åˆè¨ˆå€¤ã®ç®—å‡º</a></li><li><a href="#3-3_æ¥µå€¤ä»£è¡¨å€¤ã®ç®—å‡º">3-3 æ¥µå€¤ã€ä»£è¡¨å€¤ã®ç®—å‡º</a></li><li><a href="#3-4_ã°ã‚‰ã¤ãå…·åˆã®ç®—å‡º">3-4 ã°ã‚‰ã¤ãå…·åˆã®ç®—å‡º</a></li><li><a href="#3-5_æœ€é »å€¤ã®ç®—å‡º">3-5 æœ€é »å€¤ã®ç®—å‡º</a></li><li><a href="#3-6_é †ä½ã®ç®—å‡º">3-6 é †ä½ã®ç®—å‡º</a></li><li><a href="#q_ãƒ©ãƒ³ã‚­ãƒ³ã‚°">Q ãƒ©ãƒ³ã‚­ãƒ³ã‚°</a></li></ol></li></ol></div>
<h2 id="3_é›†ç´„"><a href="#3_é›†ç´„" class="header-anchor">3 é›†ç´„</a></h2>
<h3 id="3-1_ãƒ‡ãƒ¼ã‚¿æ•°ç¨®é¡æ•°ã®ç®—å‡º"><a href="#3-1_ãƒ‡ãƒ¼ã‚¿æ•°ç¨®é¡æ•°ã®ç®—å‡º" class="header-anchor">3-1 ãƒ‡ãƒ¼ã‚¿æ•°ã€ç¨®é¡æ•°ã®ç®—å‡º</a></h3>
<p>ãƒ›ãƒ†ãƒ«ã”ã¨ã«äºˆç´„æ•°ã€é¡§å®¢æ•°ã®é›†è¨ˆã‚’è¡Œã†ç·´ç¿’ã§ã™ã€‚ ãƒ›ãƒ†ãƒ«ã”ã¨ã«ãƒ‡ãƒ¼ã‚¿ã‚’åˆ†ã‘ã‚‹å‡¦ç†ã¯ã€groupbyé–¢æ•°ã§å®Ÿæ–½ã—ã¾ã™ã€‚</p>
<p>groupbyé–¢æ•°ã¯ã€<code>groupby&#40;df::AbstractDataFrame,cols;kwargs...&#41;</code> ã®ã‚ˆã†ã«ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ¬ãƒ¼ãƒ ã¨åˆ—åã‚’å¼•æ•°ã—ã¦ã€è¿”ã‚Šå€¤ã¯<code>GroupedDataFrame</code>ã¨ãªã‚Šã¾ã™ã€‚</p>
<p>ã‚°ãƒ«ãƒ¼ãƒ—åŒ–ã—ãŸãƒ‡ãƒ¼ã‚¿æ¯ã«é›†è¨ˆã™ã‚‹å‡¦ç†ã¯combineé–¢æ•°ã§å®Ÿæ–½ã—ã¾ã™ã€‚ combineé–¢æ•°ã¯ã€<code>GroupedDataFrame</code>ã‚’å¼•æ•°ã«ã—ã¦ã€ã•ã‚‰ã« <code>åˆ—å &#61;&gt; é–¢æ•° &#40;&#61;&gt; æ–°ã—ã„åˆ—å&#41;</code>ã®ã‚ˆã†ãªæ›¸ãæ–¹ã®å¯å¤‰é•·å¼•æ•°ã‚’ã¨ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚</p>
<p>ã“ã®å•é¡Œã¯ã€@chainãƒã‚¯ãƒ­ã‚’ç”¨ã„ãŸãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³å‡¦ç†ã«ã‚ˆã£ã¦ã€ä»¥ä¸‹ã®ã‚ˆã†ã«ã€ç°¡æ½”ã«è¨˜è¿°ã§ãã¾ã™ã€‚</p>
<pre><code class="language-julia">using Chain
df3_1&#61; @chain reserve_df begin
  groupby&#40;:hotel_id&#41;
  combine&#40;:reserve_id  &#61;&gt; length        &#61;&gt; :rsv_cnt,
          :customer_id &#61;&gt; lengthâˆ˜unique &#61;&gt; :cus_cnt&#41;
end
first&#40;df3_1&#41; |&gt; println</code></pre>
<div class="code-output"><pre><code class="plaintext">DataFrameRow
 Row â”‚ hotel_id  rsv_cnt  cus_cnt
     â”‚ String    Int64    Int64
â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   1 â”‚ h_75           12       12
</code></pre></div>
<p>äºˆç´„æ•°ã¯ã€lengthé–¢æ•°ã§é›†è¨ˆå¯èƒ½ã§ã™ã€‚ é¡§å®¢æ•°ã‚’é›†è¨ˆã™ã‚‹ã«ã¯ã€é¡§å®¢åã®é‡è¤‡ã‚’æ¶ˆã™ãŸã‚ã«ã€uniqueé–¢æ•°ã¨lengthé–¢æ•°ã‚’åˆæˆã—ãŸé–¢æ•°ã‚’åˆ©ç”¨ã—ã¾ã—ãŸã€‚</p>
<p>uniqueé–¢æ•°ã¨lengthé–¢æ•°ã‚’çµ„ã¿åˆã‚ã›ã‚‹æ›¸ãæ–¹ã¯å‰å‡¦ç†å¤§å…¨ã§ã¯æ¨å¥¨ã•ã‚Œã¦ã„ãªã„æ›¸ãæ–¹ã§ã™ãŒã€ ã“ã®ä¾‹ã§ã¯å¯èª­æ€§ãŒååˆ†é«˜ãã€å‡¦ç†é€Ÿåº¦ã‚‚ãŠãã‚‰ãå•é¡Œã«ãªã‚‰ãªã„ã§ã—ã‚‡ã†ã‹ã‚‰Awesomeã¨ã„ã†ã“ã¨ã«ã—ã¾ã™ã€‚</p>
<h3 id="3-2_åˆè¨ˆå€¤ã®ç®—å‡º"><a href="#3-2_åˆè¨ˆå€¤ã®ç®—å‡º" class="header-anchor">3-2 åˆè¨ˆå€¤ã®ç®—å‡º</a></h3>
<p>ãƒ›ãƒ†ãƒ«ã¨å®¿æ³Šäººæ•°æ¯ã«é›†è¨ˆã—ã¦ã¿ã¾ã™ã€‚è¤‡æ•°ã®åˆ—ã«ã¤ã„ã¦ã‚°ãƒ«ãƒ¼ãƒ—åˆ†ã‘ã—ã¦é›†è¨ˆã‚’è¡Œã†å ´åˆã¯ã€<code>:hote_id</code>ã¨<code>:people_num</code>ã‚’Arrayã¨ã—ã¦ã€ groupbyé–¢æ•°ã®å¼•æ•°ã«ã™ã‚Œã°OKã§ã™ã€‚ ã¾ãŸã€ã‚°ãƒ«ãƒ¼ãƒ—ã”ã¨ã«åˆ—ã®åˆè¨ˆå€¤ã‚’å‡ºåŠ›ã™ã‚‹ã«ã¯ã€sumé–¢æ•°ã‚’æŒ‡å®šã™ã‚Œã°ã‚ˆã„ã§ã™ã€‚</p>
<pre><code class="language-julia">df3_2 &#61; @chain reserve_df begin
  groupby&#40;&#91;:hotel_id,:people_num&#93;&#41;
  combine&#40;:total_price&#61;&gt; sum &#61;&gt;:price_sum&#41;
end
first&#40;df3_2&#41; |&gt; println</code></pre>
<div class="code-output"><pre><code class="plaintext">DataFrameRow
 Row â”‚ hotel_id  people_num  price_sum
     â”‚ String    Int64       Int64
â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   1 â”‚ h_75               4     421200
</code></pre></div>
<h3 id="3-3_æ¥µå€¤ä»£è¡¨å€¤ã®ç®—å‡º"><a href="#3-3_æ¥µå€¤ä»£è¡¨å€¤ã®ç®—å‡º" class="header-anchor">3-3 æ¥µå€¤ã€ä»£è¡¨å€¤ã®ç®—å‡º</a></h3>
<p>ãƒ›ãƒ†ãƒ«æ¯ã«total_priceåˆ—ã®æœ€å¤§å€¤ã€æœ€å°å€¤ã€å¹³å‡å€¤ã€ä¸­å¤®å€¤ã€20&#37;ã®ãƒ‘ãƒ¼ã‚»ãƒ³ã‚¿ã‚¤ãƒ«ã‚’å‡ºåŠ›ã—ã¾ã™ã€‚ å¹³å‡å€¤ã€ä¸­å¤®å€¤ã€ãƒ‘ãƒ¼ã‚»ãƒ³ã‚¿ã‚¤ãƒ«ã®å‡ºåŠ›ã«ã¯ã€æ–°ãŸãªé–¢æ•°ãŒå¿…è¦ãªã®ã§ã€Statistics.jlã‚’å°å…¥ã—ã¾ã™ã€‚ ãƒ‘ãƒ¼ã‚»ãƒ³ã‚¿ã‚¤ãƒ«ã¯ã€ç„¡åé–¢æ•°ã‚’ä½¿ç”¨ã™ã‚‹ãŸã‚ã€ã‚„ã‚„å†—é•·ãªæ›¸ãæ–¹ã¨ãªã£ã¦ã„ã¾ã™ã€‚</p>
<pre><code class="language-julia">using Statistics
@chain reserve_df begin
  groupby&#40;:hotel_id&#41;
  combine&#40;:total_price&#61;&gt;maximum&#61;&gt;:price_max,
          :total_price&#61;&gt;minimum&#61;&gt;:price_min,
          :total_price&#61;&gt;mean&#61;&gt;:price_mean, 
          :total_price&#61;&gt;median&#61;&gt;:price_medeian,
          :total_price&#61;&gt;&#40;r-&gt;quantile&#40;r,0.2&#41;&#41;&#61;&gt;:price_20per&#41; 
  first&#40;10&#41;
  println
end</code></pre>
<div class="code-output"><pre><code class="plaintext">10Ã—6 DataFrame
 Row â”‚ hotel_id  price_max  price_min  price_mean      price_medeian  price_20per
     â”‚ String    Int64      Int64      Float64         Float64        Float64
â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   1 â”‚ h_75          97200      16200   49950.0              36450.0      24300.0
   2 â”‚ h_219         92700      10300   46746.2              30900.0      20600.0
   3 â”‚ h_179         67200       5600   32421.1              33600.0      17920.0
   4 â”‚ h_214        437400     145800       2.51836e5       291600.0     194400.0
   5 â”‚ h_16         272400      45400       1.42174e5       136200.0      68100.0
   6 â”‚ h_241         72000       6000   29555.6              24000.0      12000.0
   7 â”‚ h_256        414000      34500       1.53682e5       103500.0      69000.0
   8 â”‚ h_217        136800      22800   78763.6              68400.0      45600.0
   9 â”‚ h_240        320400      26700  137060.0              80100.0      48060.0
  10 â”‚ h_183        118800       9900   48400.0              39600.0      29700.0
</code></pre></div>
<h3 id="3-4_ã°ã‚‰ã¤ãå…·åˆã®ç®—å‡º"><a href="#3-4_ã°ã‚‰ã¤ãå…·åˆã®ç®—å‡º" class="header-anchor">3-4 ã°ã‚‰ã¤ãå…·åˆã®ç®—å‡º</a></h3>
<p>åˆ†æ•£ã‚„æ¨™æº–åå·®ã¯ã€å¹³å‡åŒæ§˜ã«Statistics.jlã‚’usingã™ã‚Œã°ä½¿ãˆã¾ã™ã€‚ åˆ†æ•£ã‚„æ¨™æº–åå·®ã¯ã€ãƒ‡ãƒ¼ã‚¿æ•°ãŒ1ã¤ã—ã‹ãªã„å ´åˆã«ã¯NaNï¼ˆNot a Numberï¼‰ã‚’è¿”ã—ã¾ã™ã€‚</p>
<pre><code class="language-julia">using Statistics
@show var&#40;&#91;1,5,9&#93;&#41;
@show std&#40;&#91;1,5,9&#93;&#41;
@show var&#40;&#91;1&#93;&#41;
@show std&#40;&#91;1&#93;&#41;</code></pre>
<div class="code-output"><pre><code class="plaintext">var([1, 5, 9]) = 16.0
std([1, 5, 9]) = 4.0
var([1]) = NaN
std([1]) = NaN
</code></pre></div>
<p>varã¨stdã«ã¤ã„ã¦NaNã‚’0ã«å¤‰æ›´ã™ã‚‹æ–¹æ³•ã‚’èª¿æŸ»ã—ã¾ã—ãŸã€‚ã„ãã¤ã‹æ–¹æ³•ã¯ã‚ã‚Šã¾ã—ãŸãŒã€ <code>ifelse&#40;isnan&#40;x&#41;,0,x&#41;</code>ã¨ã„ã†é–¢æ•°ã‚’ä½¿ã†ã®ãŒä¸€ç•ªçŸ­ãæ›¸ã‘ãã†ã§ã™ã€‚ &#40;Rç‰ˆã®å›ç­”ã«ã‚ã‚‹coalesceé–¢æ•°ã¯juliaã«ã‚‚ã‚ã‚Šã¾ã™ãŒã€æ©Ÿèƒ½ãŒç•°ãªã‚‹ã‚ˆã†ã§ã™ã€‚&#41;</p>
<p>NaNã‚’0ã«ç½®ãæ›ãˆã‚‹å‡¦ç†ã¯ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³å‡¦ç†ã®ä¸­ã§ç„¡åé–¢æ•°ã‚’ä½¿ã£ã¦å®Ÿè£…ã™ã‚‹ã“ã¨ã‚‚ã§ãã¾ã™ãŒã€ å¯èª­æ€§ã¯ä½ã„ã®ã§ã€ãƒ–ãƒ­ãƒ¼ãƒ‰ã‚­ãƒ£ã‚¹ãƒˆæ¼”ç®—ã§æœ€å¾Œã«ã¾ã¨ã‚ã¦å‡¦ç†ã™ã‚‹ã®ãŒAwesomeã§ã—ã‚‡ã†ã€‚</p>
<pre><code class="language-julia">using Chain,Statistics,DataFrames
df3_4&#61;@chain DataFrame&#40;a&#61;&#91;&quot;ã‚&quot;,&quot;ã‚&quot;,&quot;ã„&quot;&#93;,b&#61;&#91;1,2,3&#93;&#41; begin
  groupby&#40;:a&#41;
  combine&#40;:b&#61;&gt;sum,
          :b&#61;&gt;&#40;r-&gt;ifelse&#40;isnan&#40;var&#40;r&#41;&#41;,0,var&#40;r&#41;&#41;&#41; &#61;&gt;:b_var,
          :b&#61;&gt;std&#41;
end
@show df3_4
df &#61; df3_4&#91;&#33;,2:end&#93; #ï¼’åˆ—ç›®ä»¥é™ã®viewã‚’ä½œæˆã€‚ï¼‘åˆ—ç›®ã«isnanã‚’é©ç”¨ã™ã‚‹ã¨ã‚¨ãƒ©ãƒ¼ãŒã‹ãˆã£ã¦æ¥ã¾ã™ã€‚
df .&#61; ifelse.&#40;isnan.&#40;df&#41;,0,df&#41; #ãƒ–ãƒ­ãƒ¼ãƒ‰ã‚­ãƒ£ã‚¹ãƒˆæ¼”ç®—
println&#40;&#41;
@show df3_4</code></pre>
<div class="code-output"><pre><code class="plaintext">df3_4 = 2Ã—4 DataFrame
 Row â”‚ a       b_sum  b_var    b_std
     â”‚ String  Int64  Float64  Float64
â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   1 â”‚ ã‚          3      0.5    0.707107
   2 â”‚ ã„          3      0.0  NaN

df3_4 = 2Ã—4 DataFrame
 Row â”‚ a       b_sum  b_var    b_std
     â”‚ String  Int64  Float64  Float64
â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   1 â”‚ ã‚          3      0.5  0.707107
   2 â”‚ ã„          3      0.0  0.0
</code></pre></div>
<p>ã“ã®æ–¹æ³•ã‚’ä¾‹é¡Œã«é©ç”¨ã™ã‚‹ã¨ä»¥ä¸‹ã®ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚</p>
<pre><code class="language-julia">df3_4&#61;@chain reserve_df begin 
  groupby&#40;:hotel_id&#41;
  combine&#40;:total_price&#61;&gt;var,
          :total_price&#61;&gt;std&#41;
end
df &#61; df3_4&#91;&#33;,2:end&#93; #ï¼’åˆ—ç›®ä»¥é™ã®viewã‚’ä½œæˆã€‚ï¼‘åˆ—ç›®ã«isnanã‚’é©ç”¨ã™ã‚‹ã¨ã‚¨ãƒ©ãƒ¼ãŒã‹ãˆã£ã¦æ¥ã¾ã™ã€‚
df .&#61; ifelse.&#40;isnan.&#40;df&#41;,0,df&#41; #ãƒ–ãƒ­ãƒ¼ãƒ‰ã‚­ãƒ£ã‚¹ãƒˆæ¼”ç®—
@show first&#40;df3_4,10&#41;</code></pre>
<div class="code-output"><pre><code class="plaintext">first(df3_4, 10) = 10Ã—3 DataFrame
 Row â”‚ hotel_id  total_price_var  total_price_std
     â”‚ String    Float64          Float64
â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   1 â”‚ h_75           1.09549e9     33098.2
   2 â”‚ h_219          8.59601e8     29319.0
   3 â”‚ h_179          3.08648e8     17568.4
   4 â”‚ h_214          7.47238e9     86442.9
   5 â”‚ h_16           6.57522e9     81087.7
   6 â”‚ h_241          4.53949e8     21306.1
   7 â”‚ h_256          1.77023e10        1.3305e5
   8 â”‚ h_217          1.46737e9     38306.2
   9 â”‚ h_240          1.16982e10        1.08158e5
  10 â”‚ h_183          7.94329e8     28183.9
</code></pre></div>
<div class="note"><div class="title">ğŸ˜² Note</div>
<div class="content">å‰å‡¦ç†å¤§å…¨ã®è‘—è€…ã«ã‚ˆã‚Œã°ã€ãƒ‡ãƒ¼ã‚¿ã¯ãƒ‘ãƒ¼ãƒˆãƒŠãƒ¼ã®å¿ƒã¨åŒæ§˜ã«ä¸å®‰å®šã§ã°ã‚‰ã¤ããŒã‚ã‚‹ã‚‚ã®ã ãã†ã§ã™ã€‚ åˆ†æ•£å€¤/æ¨™æº–åå·®å€¤ã¨ãƒ‘ãƒ¼ãƒˆãƒŠãƒ¼ã®æ°—æŒã¡ã‚’å¸¸ã€…æ°—ã«ã‹ã‘ãŸã„ã¨æ€ã„ã¾ã™ã€‚</div></div>
<h3 id="3-5_æœ€é »å€¤ã®ç®—å‡º"><a href="#3-5_æœ€é »å€¤ã®ç®—å‡º" class="header-anchor">3-5 æœ€é »å€¤ã®ç®—å‡º</a></h3>
<p><code>:total_price</code>ã‚’100ã®ä½ã‚’å››æ¨äº”å…¥ã—ã¦ã€æœ€é »å€¤ã‚’æ±‚ã‚ã¾ã™ã€‚ å››æ¨äº”å…¥ã¯roundé–¢æ•°ã§å®Ÿè¡Œã§ãã¾ã™ãŒã€ä¸¸ã‚ã‚‹æ¡ã¯ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰å¼•æ•°digitsã§æŒ‡å®šã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚ StatsBase.jlã‚’ã‚¤ãƒ³ãƒãƒ¼ãƒˆã—ã¦ãŠã‘ã°ã€pythonã¨åŒã˜ãmodeé–¢æ•°ã§æœ€é »å€¤ã‚’æ±‚ã‚ã‚‹ã“ã¨ãŒå¯èƒ½ã§ã™ã€‚</p>
<pre><code class="language-julia">using StatsBase
mode&#40;round.&#40;reserve_df.total_price, digits&#61;-3&#41;&#41; |&gt; println</code></pre>
<div class="code-output"><pre><code class="plaintext">20000.0
</code></pre></div>
<p>2ä¸‡å††ãã‚‰ã„ãƒ›ãƒ†ãƒ«ã«ãŠé‡‘ã‚’è½ã¨ã—ã¦ã„ã‚‹äººãŒä¸€ç•ªå¤šã„ã¨ã„ã†ã“ã¨ã§ã™ã­ã€‚</p>
<h3 id="3-6_é †ä½ã®ç®—å‡º"><a href="#3-6_é †ä½ã®ç®—å‡º" class="header-anchor">3-6 é †ä½ã®ç®—å‡º</a></h3>
<p>ãƒ›ãƒ†ãƒ«ã”ã¨ã«äºˆç´„æ—¥æ™‚é †ã®ç•ªå·ä»˜ã‘ã‚’ã—ã¦ã¿ã¾ã™ã€‚ ãã‚‚ãã‚‚äºˆç´„æ—¥æ™‚ãŒStringå‹ã¨ã—ã¦èªè­˜ã•ã‚Œã¦ã„ã‚‹ã®ã§ã€ã¾ãšã¯DateTimeå‹ã«ãƒ‘ãƒ¼ã‚¹ã—ã¾ã™ã€‚</p>
<pre><code class="language-julia">using Dates
reserve_df.reserve_datetime &#61; DateTime.&#40;reserve_df.reserve_datetime,dateformat&quot;y-m-d HH:MM:SS&quot;&#41;
reserve_df |&gt; first |&gt; println</code></pre>
<div class="code-output"><pre><code class="plaintext">DataFrameRow
 Row â”‚ reserve_id  hotel_id  customer_id  reserve_datetime     checkin_date  checkin_time  checkout_date  people_num  total_price
     â”‚ String      String    String       Dates.DateTime       Dates.Date    Dates.Time    Dates.Date     Int64       Int64
â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   1 â”‚ r1          h_75      c_1          2016-03-06T13:09:42  2016-03-26    10:00:00      2016-03-29              4        97200
</code></pre></div>
<p>ãƒ©ãƒ³ã‚­ãƒ³ã‚°ä»˜ã‘ã«å¯¾å¿œã™ã‚‹é–¢æ•°ã¯StatsBase.jlã«ç”¨æ„ã•ã‚Œã¦ã„ã¾ã™ã€‚</p>
<table><tr><th align="right">é–¢æ•°å</th><th align="right">è¡¨ç¤ºæ³•</th></tr><tr><td align="right">ordinalrank</td><td align="right">1234</td></tr><tr><td align="right">competerank</td><td align="right">1223</td></tr><tr><td align="right">denserank</td><td align="right">1223</td></tr><tr><td align="right">tiedrank</td><td align="right">1 2.5 2.5 4</td></tr></table>
<p>ãƒ©ãƒ³ã‚­ãƒ³ã‚°æ–¹æ³•ã«ã‚‚ã„ãã¤ã‹ç¨®é¡ãŒã‚ã‚Šã¾ã™ãŒã€æ—¥æ™‚ãŒå®Œå…¨ã«ä¸€è‡´ã™ã‚‹ã“ã¨ã¯ãªã„ã§ã—ã‚‡ã†ã‹ã‚‰ã€ ã“ã“ã§ã¯<code>ordinalrank</code>ã‚’åˆ©ç”¨ã—ã¾ã™ã€‚</p>
<p>å‰å‡¦ç†ã®æ‰‹é †ã¨ã—ã¦ã¯ã€groupbyé–¢æ•°ã§hotel_idæ¯ã«ãƒ‡ãƒ¼ã‚¿ã‚’åˆ†ã‘ã¦ã€selecté–¢æ•°ã§å¿…è¦ãªåˆ—ã‚’é¸ã³ã¾ã™ã€‚</p>
<p>selecté–¢æ•°ã®å¼•æ•°ã¯<code>:åˆ—å &#61;&gt; å‡¦ç† &#61;&gt; :æ–°ã—ã„åˆ—å</code>ã¨ã„ã†ã‚ˆã†ã«combineé–¢æ•°ã¨åŒã˜ã‚ˆã†ãªä¸ãˆæ–¹ãŒå¯èƒ½ã§ã™ã€‚ ã§ã¯ã‚„ã£ã¦ã¿ã¾ã™ã€‚</p>
<pre><code class="language-julia">using StatsBase
@chain reserve_df begin
  groupby&#40;:hotel_id&#41;
  select&#40;:,:reserve_datetime &#61;&gt; ordinalrank &#61;&gt;:log_no&#41;
  first&#40;10&#41;
  println
end</code></pre>
<p><div class="code-output"><pre><code class="plaintext">10Ã—10 DataFrame
 Row â”‚ hotel_id  reserve_id  customer_id  reserve_datetime     checkin_date  checkin_time  checkout_date  people_num  total_price  log_no
     â”‚ String    String      String       Dates.DateTime       Dates.Date    Dates.Time    Dates.Date     Int64       Int64        Int64
â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   1 â”‚ h_75      r1          c_1          2016-03-06T13:09:42  2016-03-26    10:00:00      2016-03-29              4        97200       3
   2 â”‚ h_219     r2          c_1          2016-07-16T23:39:55  2016-07-20    11:30:00      2016-07-21              2        20600       4
   3 â”‚ h_179     r3          c_1          2016-09-24T10:03:17  2016-10-19    09:00:00      2016-10-22              2        33600      12
   4 â”‚ h_214     r4          c_1          2017-03-08T03:20:10  2017-03-29    11:00:00      2017-03-30              4       194400       9
   5 â”‚ h_16      r5          c_1          2017-09-05T19:50:37  2017-09-22    10:30:00      2017-09-23              3        68100      18
   6 â”‚ h_241     r6          c_1          2017-11-27T18:47:05  2017-12-04    12:00:00      2017-12-06              3        36000      25
   7 â”‚ h_256     r7          c_1          2017-12-29T10:38:36  2018-01-25    10:30:00      2018-01-28              1       103500      11
   8 â”‚ h_241     r8          c_1          2018-05-26T08:42:51  2018-06-08    10:00:00      2018-06-09              1         6000      26
   9 â”‚ h_217     r9          c_2          2016-03-05T13:31:06  2016-03-25    09:30:00      2016-03-27              3        68400       2
  10 â”‚ h_240     r10         c_2          2016-06-25T09:12:22  2016-07-14    11:00:00      2016-07-17              4       320400       4
</code></pre></div> ä¸€ç•ªå³ã®åˆ—ã«<code>:log_no</code>ã®åˆ—ãŒè¿½åŠ ã•ã‚Œã¦ã„ã‚‹ã“ã¨ãŒç¢ºèªã§ãã¾ã™ã€‚</p>
<h3 id="q_ãƒ©ãƒ³ã‚­ãƒ³ã‚°"><a href="#q_ãƒ©ãƒ³ã‚­ãƒ³ã‚°" class="header-anchor">Q ãƒ©ãƒ³ã‚­ãƒ³ã‚°</a></h3>
<p>ãƒ›ãƒ†ãƒ«æ¯ã«äºˆç´„æ•°ã‚’é›†è¨ˆã—ã¦ã€ãƒ©ãƒ³ã‚­ãƒ³ã‚°ä»˜ã‘ã‚’è¡Œã„ã¾ã™ã€‚åŒã˜äºˆç´„æ•°ã®å ´åˆã¯ã€ æœ€å°ã®é †ä½ã‚’ä»˜ã‘ã‚‹ã“ã¨ã«ãªã£ã¦ã„ã‚‹ã®ã§ã€ordinalrankã§ã¯ãªãã¦ã€competerankã‚’åˆ©ç”¨ã—ã¾ã™ã€‚</p>
<pre><code class="language-julia">@chain reserve_df begin
  groupby&#40;:hotel_id&#41;
  combine&#40;:reserve_id &#61;&gt; length &#61;&gt; :rsv_cnt&#41;
  select&#40;:,:rsv_cnt &#61;&gt; competerank &#61;&gt;:rsv_cnt_rank&#41;
  first&#40;10&#41;
  println
end</code></pre>
<div class="code-output"><pre><code class="plaintext">10Ã—3 DataFrame
 Row â”‚ hotel_id  rsv_cnt  rsv_cnt_rank
     â”‚ String    Int64    Int64
â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   1 â”‚ h_75           12           100
   2 â”‚ h_219          13           127
   3 â”‚ h_179          19           270
   4 â”‚ h_214          11            67
   5 â”‚ h_16           19           270
   6 â”‚ h_241          27           300
   7 â”‚ h_256          11            67
   8 â”‚ h_217          11            67
   9 â”‚ h_240          15           187
  10 â”‚ h_183          18           259
</code></pre></div>
<p>
  <div class="prev-next-link">
  <a class="prev-link" href="https://hanafsky.com//tips/preprocess1">
    <p class="prev-next-label">å‰ã®è¨˜äº‹</p>
    <p>
       Awesome ãªå‰å‡¦ç†1
    </p>
  </a>
  <a class="next-link" href="https://hanafsky.com//tips/preprocess3">
    <p class="prev-next-label">æ¬¡ã®è¨˜äº‹</p>
    <p>
       Awesome ãªå‰å‡¦ç†3
    </p>
  </a>
</div>
  <button onclick="topFunction()" id="myBtn" title="Go to top">Top</button> </p>
<div class="page-foot">
  <div class="copyright">
    &copy; Kei Hanafusa. Last modified: April 04, 2021. Website built with <a href="https://github.com/tlienart/Franklin.jl">Franklin.jl</a> and the <a href="https://julialang.org">Julia programming language</a>.
  </div>
</div>
</div><!-- CONTENT ENDS HERE -->

      </div> <!-- closure of main -->
    </div>   <!-- closure of class initial--content -->

    <div class="page__footer">
      <footer>
        <!-- start custom footer snippets -->
        <!-- end custom footer snippets -->
        <div class="page__footer-follow">
          <ul class="social-icons">
            <li><strong>Follow:</strong></li>
            <li><a href="https://twitter.com/hanafusakei" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-twitter-square" aria-hidden="true"></i> Twitter</a></li>
            <li><a href="https://github.com/hanafsky" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-github" aria-hidden="true"></i> GitHub</a></li>
          </ul>
        </div>
        <div class="page__footer-copyright">&copy; Kei Hanafusa. Powered by <a href="https://github.com/tlienart/Franklin.jl">Franklin</a> &amp; <a href="https://mademistakes.com/work/minimal-mistakes-jekyll-theme/" rel="nofollow">Minimal Mistakes</a>.</div>
      </footer>
    </div>

    <script src="/libs/minimal-mistakes/main.min.js"></script>
    <script defer src="https://use.fontawesome.com/releases/v5.8.2/js/all.js" integrity="sha384-DJ25uNYET2XCl5ZF++U8eNxPWqcKohUUBUpKGlNLMchM7q4Wjg2CUpjHLaL8yYPH" crossorigin="anonymous"></script>
    <script src="/libs/myBtn/myBtn.js"></script>
    <script src="/libs/luminous/Luminous.min.js"></script>

    
    
        <script src="/libs/highlight/highlight.pack.js"></script>
<script>hljs.initHighlightingOnLoad();hljs.configure({tabReplace: '    '});</script>

    
    
    <script>
    new Luminous(document.querySelectorAll('.zoom'));
</script>
    <script>
function myToc() {
    var x = document.getElementsByClassName("mytoc");
    if (x.style.display === "none") {
      x.style.display = "block";
    } else {
      x.style.display = "none";
    }
  } 
</script>
  </body>
</html>
